
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists <unk> <unk> ists","autodesk bbs","polysyllabic polysyllabic","unsubscribe","unsubscribe","dir","bullshit","isbn","yep","commodore cdtv","mhz iisi","<unk>","<unk> <unk>","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","compuserve com","lou gehrig <unk>","deleted","abolish cults","pierre turgeon islanders","ken","liar cheat <unk>","comp graphics faq","secrecy lds ceremonies clh","dino ciccarelli ray sheppard","mjones donald aix kingston ibm com","posted","fox <unk> dave feustel nmyi feustel netcom com","<unk> jeremy scott noonan","xli xloadimage goto flag","dancing <unk>","virtualgrabkeys resource belongs olvwm","subscribe <unk> <unk> eve <unk>","exit","okay okay forgot <unk>","xli xloadimage imagemagick export lcs mit edu contrib","article <unk> sys bison baden sys bison baden bari","quoting dougb ecs comm mot com article apr <unk> comm mot com","<unk> fantasy <unk> dear elf","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","<unk> file dis <unk> file tga","insult gregg resorts lies","objects <unk>","dreams","article apr nmt edu erickson <unk> nmt edu alan erickson","flat engine","<unk> phones","alt religion spam","brandon wise <unk> nyx edu","gee forgotten nut"];
var att_heads = [6,0,0,3,3,0,3,2,0,0,0,0,0,9,7,7,0,9,5,1,9,0,0,1,3,1,7,1,1,1,3,0,1,0,0,0,0,1,1,1,0,9,0,1,2,1,0,4,1,3];
var trigram_weights = [[0.0001781660394044593, 0.16649578511714935, 0.0004235232772771269, 0.16649578511714935, 0.16649578511714935, 0.0004235232772771269],[0.00630233995616436, 0.007192049641162157],[0.0006929195369593799, 0.0006929195369593799],[0.004199748393148184],[0.0010532545857131481],[0.008368046954274178],[0.04971422255039215],[0.008878765627741814],[0.05462944880127907],[0.30916693806648254, 0.0010062652872875333],[0.09323912858963013, 0.000616125063970685],[0.3333333432674408],[0.3333333432674408, 0.3333333432674408],[0.08255042880773544, 0.0294841006398201, 0.0294841006398201, 0.3240455687046051, 0.003812044160440564, 0.00018940807785838842, 0.0294841006398201, 0.3240455687046051, 0.0294841006398201],[0.01908252201974392, 0.9004004001617432],[0.8546949028968811, 0.04418536275625229, 0.050559837371110916],[0.8718964457511902],[0.502709150314331, 0.043104708194732666],[0.31444302201271057, 0.0006353177595883608, 0.6258289217948914],[0.993560791015625],[0.09344954043626785, 0.8932628035545349, 0.006643785163760185],[0.0001536198251415044, 0.9828745126724243, 0.0001792394177755341],[0.7602925300598145, 0.0004436002636794001, 0.2192140817642212, 0.010024926625192165],[0.00036131011438556015, 3.5862829008692643e-06, 0.999424934387207, 0.0002101790887536481],[0.00456008967012167, 0.6234521865844727, 3.647372795967385e-05, 0.0010088541312143207, 0.32082071900367737, 0.05012161284685135],[0.9933410286903381],[0.17773672938346863, 0.0020372415892779827, 0.7931655645370483, 6.668283458566293e-05, 0.0020372415892779827, 6.668283458566293e-05, 7.062664371915162e-05, 0.022781917825341225],[0.0024941284209489822, 0.1290285587310791, 0.8658567667007446, 0.00012646372488234192],[6.44411557004787e-05, 0.009840549901127815, 0.0010613977210596204, 0.989033579826355],[0.9938046932220459, 0.003097627544775605],[0.0013101435033604503, 0.05044395476579666, 0.9469358325004578, 0.0013101435033604503],[0.16318991780281067, 0.014353753067553043, 0.014353753067553043, 0.7793951630592346, 0.014353753067553043],[0.9822367429733276],[0.452238529920578, 0.452238529920578, 0.09512247890233994, 0.00020023198158014566],[2.8834905606345274e-05, 0.004660275299102068, 0.004660275299102068, 0.9566452503204346, 2.8320151614025235e-05, 0.024626120924949646, 3.029790059372317e-05, 0.004660275299102068],[0.994595468044281, 0.0012369524920359254, 1.2062444056937238e-06, 0.002025863155722618, 4.70527375000529e-05, 1.2062444056937238e-06, 0.002025863155722618, 4.70527375000529e-05, 1.9314604287501425e-05],[0.04861469939351082, 0.0011462856782600284, 2.732904704316752e-06, 4.4219129335942853e-07, 7.686559001740534e-06, 0.013689706102013588, 0.9216930866241455, 1.219625801240909e-06, 0.0011462856782600284, 4.4219129335942853e-07, 7.686559001740534e-06, 0.013689706102013588],[0.0017620439175516367, 0.4026923179626465, 0.0017620439175516367, 0.5902246832847595, 0.0017969394102692604],[0.0014148036716505885, 0.0014148036716505885, 0.0014148036716505885, 0.0014148036716505885, 0.0014148036716505885, 9.411648534296546e-06, 8.376232290174812e-05, 0.0014148036716505885, 0.0014148036716505885, 0.0014148036716505885, 9.411648534296546e-06, 0.9871640205383301],[0.9886643290519714],[0.0016142548993229866, 0.4975460171699524, 6.467154162237421e-05, 0.0016142548993229866, 0.4975460171699524, 5.250417984825617e-07],[0.6386091113090515, 0.009861422702670097, 0.06503597646951675, 0.28522324562072754],[0.988030731678009, 0.0059846751391887665],[0.9895750880241394],[0.6732463240623474, 9.182064673041168e-07, 6.626548838539748e-07, 5.6587000472063664e-06, 0.0025005126371979713, 0.0008603287278674543, 6.626548838539748e-07, 5.6587000472063664e-06, 0.3208787441253662, 0.0025005126371979713],[0.9244389533996582, 0.06751491129398346],[0.005129171069711447, 0.9897416830062866],[0.0002175510599045083, 0.956798255443573, 0.04298416152596474],[0.0025772545486688614, 0.9965142607688904, 0.000893935386557132, 8.64285266288789e-06, 5.9466979109856766e-06],[0.0033939899876713753, 0.9948492646217346, 0.0010801430325955153]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>