
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["dir","isbn","mhz iisi","commodore cdtv","autodesk bbs","unsubscribe","unsubscribe","urn <unk>","lou gehrig <unk>","polysyllabic polysyllabic","deleted","ken","<unk> jeremy scott noonan","david","apr <unk> ists <unk> <unk> ists","italy sweden canada sweden russia italy","mjones donald aix kingston ibm com","pierre turgeon islanders","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","compuserve com","dino ciccarelli ray sheppard","<unk> phones","exit","bill mcd","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","dancing <unk>","test","test","dreams","posted","please subscrive","please subscrive","jesus peace","cheek","career mattingly","xli xloadimage imagemagick export lcs mit edu contrib","shut andi","comp graphics faq","objects ufos","caching drive","liar cheat demagogue","secrecy lds ceremonies clh","<unk> order","mistake","ultimate <unk>","<unk> <unk> project arizona","religious fanaticism","fox <unk> dave feustel nmyi feustel netcom com","fuhr rings <unk> errey bob rings","ignore"];
var att_heads = [3,6,0,8,3,8,8,3,0,1,6,8,0,0,5,2,9,2,8,8,0,9,9,8,2,1,5,5,0,6,7,7,2,7,9,0,8,9,0,8,9,3,9,6,1,0,9,2,7,5];
var trigram_weights = [[0.014546982944011688],[0.015502155758440495],[0.0381903275847435, 0.9618096947669983],[0.06184536963701248, 0.9381546378135681],[0.8337169885635376, 0.16628298163414001],[0.055057454854249954],[0.055057454854249954],[0.11355764418840408, 0.8864423632621765],[0.030581967905163765, 0.32313933968544006, 0.32313933968544006],[0.018283748999238014, 0.018283748999238014],[0.3365294337272644],[0.30791130661964417],[0.34242358803749084, 0.11456634849309921, 0.20058651268482208, 0.34242358803749084],[0.2989136576652527],[0.07487678527832031, 0.21954132616519928, 0.023478930816054344, 0.21954132616519928, 0.21954132616519928, 0.023478930816054344],[0.08977462351322174, 0.03116672672331333, 0.09340188652276993, 0.03116672672331333, 0.05680226534605026, 0.08977462351322174],[0.4740699529647827, 0.2244541496038437, 0.02450926974415779, 0.03691204637289047, 0.06168283522129059, 0.17837177217006683],[0.04417744651436806, 0.37866124510765076, 0.19850005209445953],[0.141604945063591, 0.141604945063591, 0.141604945063591, 0.141604945063591, 0.02451450377702713, 0.01793547533452511, 0.008943518623709679, 0.141604945063591, 0.141604945063591, 0.02451450377702713, 0.01793547533452511, 0.05652688071131706],[0.04202219471335411, 0.045139409601688385],[0.10349034518003464, 0.5425617098808289, 0.3153596520423889, 0.03858832269906998],[0.6468852758407593, 0.35311469435691833],[0.40540066361427307],[0.10129708051681519, 0.004575282335281372],[0.05251045525074005, 0.15277338027954102, 0.15277338027954102, 0.1436128318309784, 0.027202287688851357, 0.021968061104416847, 0.15277338027954102, 0.1436128318309784, 0.15277338027954102],[0.492349773645401, 0.5076502561569214],[0.3469516336917877],[0.3469516336917877],[0.44835183024406433],[0.48179754614830017],[0.49967706203460693, 0.5003229379653931],[0.49967706203460693, 0.5003229379653931],[0.21235598623752594, 0.7876440286636353],[0.5151947140693665],[0.461148738861084, 0.538851261138916],[0.008404604159295559, 0.3337193727493286, 0.03737042844295502, 0.2041665017604828, 0.3337193727493286, 0.009496940299868584, 0.045475345104932785, 0.027647459879517555],[0.6964707970619202, 0.3035292327404022],[0.14572860300540924, 0.375112920999527, 0.05969316512346268],[0.8365329504013062, 0.16346704959869385],[0.07966812700033188, 0.9203318953514099],[0.19993174076080322, 0.14802363514900208, 0.3586350083351135],[0.19218839704990387, 0.10268907248973846, 0.20868977904319763, 0.4964327812194824],[0.3771842122077942, 0.6228158473968506],[0.5358448624610901],[0.5035237073898315, 0.49647635221481323],[0.24739399552345276, 0.24739399552345276, 0.2323872148990631, 0.025430740788578987],[0.7829219698905945, 0.21707801520824432],[0.08399685472249985, 0.15608666837215424, 0.07571136951446533, 0.15608666837215424, 0.15608666837215424, 0.15608666837215424, 0.15608666837215424, 0.05985838919878006],[0.004548525903373957, 0.13079096376895905, 0.262964129447937, 0.262964129447937, 0.20794127881526947, 0.13079096376895905],[0.6255430579185486]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>