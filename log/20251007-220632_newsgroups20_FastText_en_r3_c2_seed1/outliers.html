
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","<unk>","dir","isbn","commodore cdtv","autodesk bbs","mhz iisi","unsubscribe","unsubscribe","deleted","lou gehrig <unk>","polysyllabic polysyllabic","ken","<unk> jeremy scott noonan","david","apr <unk> ists <unk> <unk> ists","italy sweden canada sweden russia italy","mjones donald aix kingston ibm com","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","exit","compuserve com","dino ciccarelli ray sheppard","pierre turgeon islanders","bill mcd","<unk> phones","dancing <unk>","posted","test","test","dreams","jesus peace","please subscrive","please subscrive","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","ignore","shut andi","career mattingly","fox <unk> dave feustel nmyi feustel netcom com","kent wife","bullshit","objects <unk>","mistake","joke","secrecy lds ceremonies clh","alt religion spam","liar cheat <unk>","please subscribe","please subscribe","please subscribe","<unk> subscrive please subscribe"];
var att_heads = [0,0,1,1,1,1,1,1,1,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,1,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,2];
var trigram_weights = [[0.5, 0.5],[0.5],[0.8011519908905029],[0.7351563572883606],[0.3228852152824402, 0.09673069417476654],[0.46776968240737915, 0.5322303175926208],[0.7462846636772156, 0.2537153959274292],[0.02036093734204769],[0.1270102709531784],[0.9767237901687622],[0.3532973825931549, 0.21556755900382996, 0.21556755900382996],[0.5, 0.5],[0.746600866317749],[0.3022592067718506, 0.2881964147090912, 0.10728518664836884, 0.3022592067718506],[0.6601973176002502],[0.3300551474094391, 0.09892479330301285, 0.13712288439273834, 0.09892479330301285, 0.09892479330301285, 0.13712288439273834],[0.07804595679044724, 0.1511695384979248, 0.24789142608642578, 0.1511695384979248, 0.24593354761600494, 0.07804595679044724],[0.07095041126012802, 0.1579260677099228, 0.15824200212955475, 0.09516359865665436, 0.28356197476387024, 0.16320551931858063],[0.062132399529218674, 0.062132399529218674, 0.062132399529218674, 0.062132399529218674, 0.047932397574186325, 0.19374263286590576, 0.023139452561736107, 0.062132399529218674, 0.062132399529218674, 0.047932397574186325, 0.19374263286590576, 0.12071607261896133],[0.6148145198822021],[0.2849887013435364, 0.7150112986564636],[0.22682075202465057, 0.08348407596349716, 0.39291414618492126, 0.21329690515995026],[0.5324177742004395, 0.10698871314525604, 0.25360479950904846],[0.706561267375946, 0.29343873262405396],[0.15009815990924835, 0.5497055053710938],[0.5515755414962769, 0.44842445850372314],[0.9962235689163208],[0.6059727668762207],[0.6059727668762207],[0.717951238155365],[0.4997013509273529, 0.5002986192703247],[0.9937667846679688, 0.006233195774257183],[0.9937667846679688, 0.006233195774257183],[0.02229967527091503, 0.059529826045036316, 0.059529826045036316, 0.14253434538841248, 0.030765831470489502, 0.18562722206115723, 0.059529826045036316, 0.14253434538841248, 0.059529826045036316],[0.9870979189872742],[0.9794411659240723, 0.020558809861540794],[0.9338237643241882, 0.06617618352174759],[0.49873292446136475, 0.06314446777105331, 0.0402950793504715, 0.06314446777105331, 0.06314446777105331, 0.06314446777105331, 0.06314446777105331, 0.14524969458580017],[0.30532070994377136, 0.6946792602539062],[0.3917412757873535],[0.9153808951377869, 0.08461912721395493],[0.4889466464519501],[0.743714451789856],[0.2990685701370239, 0.006573623977601528, 0.5560032725334167, 0.06917724013328552],[0.006295251194387674, 0.7596087455749512, 0.1566675305366516],[0.7638462781906128, 0.005271606612950563, 0.11544102430343628],[0.9115883111953735, 0.08841168135404587],[0.9115883111953735, 0.08841168135404587],[0.9115883111953735, 0.08841168135404587],[0.005621323827654123, 0.005621323827654123, 0.8962152600288391, 0.08692070096731186]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>