
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk>","<unk> <unk>","dir","isbn","commodore cdtv","mhz iisi","unsubscribe","unsubscribe","autodesk bbs","polysyllabic polysyllabic","deleted","ken","lou gehrig <unk>","apr <unk> ists <unk> <unk> ists","david","dreams","<unk> jeremy scott noonan","italy sweden canada sweden russia italy","exit","dancing <unk>","please subscrive","please subscrive","objects <unk>","career mattingly","<unk> phones","test","test","posted","mistake","unfortunately","alt law enforcement","consistently","joke","bill mcd","pierre turgeon islanders","alt religion spam","ignore","bullshit","religious fanaticism","<unk> order","ultimate <unk>","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","yes","compuserve com","simple","mjones donald aix kingston ibm com","<unk> weasel <unk> later","jesus peace","tell","dino ciccarelli ray sheppard"];
var att_heads = [0,0,0,0,0,0,0,0,0,2,4,0,0,0,0,2,0,0,3,1,0,0,1,1,1,2,2,4,2,4,1,4,2,0,0,1,3,0,2,1,2,0,0,0,2,0,2,0,3,0];
var trigram_weights = [[0.5],[0.5, 0.5],[0.9248403310775757],[0.8466874957084656],[0.6818076372146606, 0.31819236278533936],[0.912874698638916, 0.08712531626224518],[0.6816861033439636],[0.6816861033439636],[0.08453959971666336, 0.9154604077339172],[0.5, 0.5],[0.990199625492096],[0.7765598893165588],[0.7311606407165527, 0.08961311727762222, 0.08961311727762222],[0.24735800921916962, 0.04447817802429199, 0.309603750705719, 0.04447817802429199, 0.04447817802429199, 0.309603750705719],[0.9328148365020752],[0.3032524883747101],[0.03986601531505585, 0.4500308930873871, 0.4303710162639618, 0.03986601531505585],[0.06637317687273026, 0.28269651532173157, 0.12517410516738892, 0.28269651532173157, 0.12593843042850494, 0.06637317687273026],[0.9694748520851135],[0.894271731376648, 0.10572826117277145],[0.7938528656959534, 0.20614713430404663],[0.7938528656959534, 0.20614713430404663],[0.9946019649505615, 0.005398031324148178],[0.992770254611969, 0.007229716517031193],[0.00478213420137763, 0.9952179193496704],[0.7792160511016846],[0.7792160511016846],[0.9929196238517761],[0.7135756015777588],[0.9602426886558533],[0.007697300519794226, 0.40285152196884155, 0.5878128409385681],[0.9441199898719788],[0.36530113220214844],[0.024592408910393715, 0.975407600402832],[0.8879363536834717, 0.05174487456679344, 0.008573961444199085],[0.07949895411729813, 0.3242647647857666, 0.5793153643608093],[0.9990704655647278],[0.20271335542201996],[0.9401718378067017, 0.05982815474271774],[0.014289198443293571, 0.9857107996940613],[0.9736437797546387, 0.026356233283877373],[0.009062503464519978, 0.009062503464519978, 0.009062503464519978, 0.009062503464519978, 0.23470641672611237, 0.11522708088159561, 0.119932159781456, 0.009062503464519978, 0.009062503464519978, 0.23470641672611237, 0.11522708088159561, 0.125825896859169],[0.6856319308280945],[0.594077467918396, 0.4059225022792816],[0.9839337468147278],[0.012341207824647427, 0.12658150494098663, 0.29503968358039856, 0.1480909287929535, 0.3109929859638214, 0.09461242705583572],[0.06518442928791046, 0.03669217228889465, 0.06518442928791046, 0.8329390287399292],[0.9886950850486755, 0.011304966174066067],[0.9994626641273499],[0.12387224286794662, 0.03424670919775963, 0.11652107536792755, 0.7253599762916565]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>