
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists <unk> <unk> ists","polysyllabic polysyllabic","autodesk bbs","dir","unsubscribe","unsubscribe","bullshit","isbn","commodore cdtv","yep","mhz iisi","<unk> <unk>","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","compuserve com","deleted","lou gehrig <unk>","abolish cults","cheek","pierre turgeon islanders","comp graphics faq","ken","liar cheat <unk>","quoting dougb ecs comm mot com article apr <unk> comm mot com","posted","dino ciccarelli ray sheppard","secrecy lds ceremonies clh","mjones donald aix kingston ibm com","kent wife","<unk> jeremy scott noonan","xli xloadimage goto flag","xli xloadimage imagemagick export lcs mit edu contrib","exit","dancing <unk>","subscribe <unk> <unk> eve <unk>","fluffy fantasy <unk> dear elf","virtualgrabkeys resource belongs olvwm","article apr nmt edu erickson <unk> nmt edu alan erickson","<unk> file dis <unk> file tga","article <unk> sys bison baden sys bison baden bari","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","insult gregg <unk> lies","<unk> phones","objects ufos","fox <unk> dave feustel nmyi feustel netcom com","flat engine","okay okay forgot <unk>","disks erase carrying bag","newsgroup discusses graphic design pcs macs","article apr csi jpl nasa gov <unk> <unk> jpl nasa gov dan <unk>"];
var att_heads = [4,4,4,3,4,4,4,4,2,4,4,0,4,9,0,1,8,9,5,4,9,1,4,9,9,1,9,4,9,9,7,9,9,4,9,2,4,2,2,1,1,4,3,4,4,8,9,9,4,4];
var trigram_weights = [[0.0009933410910889506, 0.33242762088775635, 0.0008619020227342844, 0.33242762088775635, 0.33242762088775635, 0.0008619020227342844],[0.5, 0.5],[0.18970757722854614, 0.8102924227714539],[0.031242139637470245],[0.0019058006582781672],[0.01504568848758936],[0.06566011160612106],[0.01946892961859703],[0.9994833469390869, 0.0005165695329196751],[0.06192491948604584],[0.9624224901199341, 0.03757758438587189],[0.5, 0.5],[0.5863469839096069, 0.036588024348020554, 0.036588024348020554, 0.12717819213867188, 0.011892875656485558, 0.0010517614427953959, 0.036588024348020554, 0.12717819213867188, 0.036588024348020554],[0.0018786649452522397, 0.9981213212013245],[0.8320586085319519],[0.9754651188850403, 0.009362267330288887, 0.007586329709738493],[0.7192845344543457, 0.2807154059410095],[0.8924803733825684],[0.5705985426902771, 0.0003021031734533608, 0.4056098163127899],[0.001442832755856216, 0.9794716835021973, 0.00022939141490496695],[0.9906902313232422],[0.0523020401597023, 0.9379134774208069, 0.004892242606729269],[0.049689680337905884, 0.002582327462732792, 4.744936177303316e-06, 2.2488955437438563e-05, 0.0002786128898151219, 0.2740625739097595, 0.3938235342502594, 7.716364052612334e-06, 0.002582327462732792, 2.2488955437438563e-05, 0.0002786128898151219, 0.2740625739097595],[0.9264277815818787],[0.0002733764995355159, 6.274824954743963e-06, 0.9953292608261108, 0.001840798882767558],[0.6536233425140381, 0.005090437829494476, 0.31754377484321594, 0.02374240756034851],[0.0016583417309448123, 0.3496222198009491, 2.1323185137589462e-05, 0.0010118801146745682, 0.4689306318759918, 0.17875570058822632],[0.622298538684845, 0.36261898279190063],[0.002837867708876729, 0.031043747439980507, 0.9498934745788574, 0.0020354539155960083],[0.0001884885277831927, 0.02798735536634922, 0.0007933075539767742, 0.9710308313369751],[5.636591595248319e-05, 0.008950578980147839, 0.008950578980147839, 0.9341874122619629, 0.0003225287364330143, 0.029361804947257042, 0.00026955967769026756, 0.008950578980147839],[0.9951174259185791],[0.9926568865776062, 0.007343093398958445],[0.17816291749477386, 0.04362888261675835, 0.04362888261675835, 0.6909504532814026, 0.04362888261675835],[0.002393649658188224, 0.1757737100124359, 0.0030683614313602448, 0.815147876739502, 0.0036163944751024246],[0.003333867294713855, 0.07445633411407471, 0.9155420064926147, 0.003333867294713855],[0.34936538338661194, 6.845273219369119e-06, 8.02889553597197e-06, 6.585184746654704e-05, 0.0026407206896692514, 0.0022908130194991827, 8.02889553597197e-06, 6.585184746654704e-05, 0.6406169533729553, 0.0026407206896692514],[0.0010535222245380282, 0.49840956926345825, 1.8078759239870124e-05, 0.0010535222245380282, 0.49840956926345825, 2.127342895619222e-06],[0.9891208410263062, 0.006799575872719288, 1.3436454537441023e-05, 0.0011425229022279382, 0.0003847170155495405, 1.3436454537441023e-05, 0.0011425229022279382, 0.0003847170155495405, 0.0009981774492189288],[0.0017982205608859658, 0.0017982205608859658, 0.0017982205608859658, 0.0017982205608859658, 0.0017982205608859658, 5.208486982155591e-05, 6.515980930998921e-05, 0.0017982205608859658, 0.0017982205608859658, 0.0017982205608859658, 5.208486982155591e-05, 0.9836466908454895],[0.9981752634048462],[0.7358615398406982, 0.0030231415294110775, 0.0024825448635965586, 0.24622005224227905],[0.009451290592551231, 0.9716460704803467],[0.9929053783416748, 0.007094569504261017],[0.5307018756866455, 0.0017069804016500711, 0.28297969698905945, 5.266071639198344e-06, 0.0017069804016500711, 5.266071639198344e-06, 2.4983039111248218e-05, 0.18116192519664764],[0.5727813839912415, 0.42721864581108093],[0.06924531608819962, 0.06924531608819962, 0.8596320748329163, 0.0009386629681102931],[0.0034902135375887156, 0.0570094995200634, 0.20188097655773163, 0.736463189125061],[0.0008978816331364214, 0.01859680376946926, 0.02710440568625927, 0.9087725877761841, 0.0439947172999382, 0.0006336399237625301],[0.2543962895870209, 4.984502993465867e-06, 0.001489152549766004, 1.2642058209166862e-05, 0.13150250911712646, 0.00022318401897791773, 0.0016680938424542546, 0.0016680938424542546, 1.2642058209166862e-05, 0.13150250911712646, 0.00022318401897791773, 0.4739604592323303, 0.0016680938424542546]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>