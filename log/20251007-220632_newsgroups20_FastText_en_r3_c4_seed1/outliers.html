
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["dir","isbn","commodore cdtv","mhz iisi","unsubscribe","unsubscribe","polysyllabic polysyllabic","autodesk bbs","urn <unk>","deleted","ken","lou gehrig <unk>","exit","posted","test","test","<unk> phones","dancing <unk>","dreams","cheek","consistently","ignore","apr <unk> ists <unk> <unk> ists","ultimate <unk>","david","mistake","career mattingly","please subscrive","please subscrive","simple","<unk> jeremy scott noonan","<unk> order","compuserve com","wanted sips","unfortunately","<unk> <unk> easy poke","good","joke","inline inline correct","bill mcd","religious fanaticism","italy sweden canada sweden russia italy","tell","flat engine","got <unk>","alt religion spam","bullshit","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","caching drive","yes"];
var att_heads = [0,0,0,0,0,0,2,0,2,1,0,0,2,1,2,2,2,2,2,2,1,1,0,2,0,2,2,1,1,1,0,2,0,1,1,1,1,2,1,2,2,0,1,2,1,2,2,0,1,0];
var trigram_weights = [[0.3303835391998291],[0.7102521657943726],[0.2230738252401352, 0.11098945140838623],[0.8021292090415955, 0.09893538057804108],[0.13040319085121155],[0.13040319085121155],[0.0939464196562767, 0.0939464196562767],[0.11231278628110886, 0.7753744125366211],[0.7437881827354431, 0.12810593843460083],[0.3004852533340454],[0.646149754524231],[0.8634487390518188, 0.06827568262815475, 0.06827568262815475],[0.06556214392185211],[0.9247398972511292],[0.7119357585906982],[0.7119357585906982],[0.045700233429670334, 0.9085995554924011],[0.8305445313453674, 0.08472774922847748],[0.9297695755958557],[0.29996582865715027],[0.7416728734970093],[0.9089971780776978],[0.32369765639305115, 0.03269662708044052, 0.28910622000694275, 0.03269662708044052, 0.03269662708044052, 0.28910622000694275],[0.8392935395240784, 0.08035322278738022],[0.9132364392280579],[0.7844399809837341],[0.9842200875282288, 0.00789000652730465],[0.7262659072875977, 0.13686703145503998],[0.7262659072875977, 0.13686703145503998],[0.16664928197860718],[0.020447345450520515, 0.5062119960784912, 0.4528932571411133, 0.020447345450520515],[0.026430850848555565, 0.8149840235710144],[0.7092773914337158, 0.23609137535095215],[0.948488712310791, 0.0009196311002597213],[0.34746453166007996],[0.08351478725671768, 0.08351478725671768, 0.033164165914058685, 0.7998062372207642],[0.08515980839729309],[0.7254993319511414],[0.0007076028850860894, 0.0007076028850860894, 0.888215959072113],[0.7005630731582642, 0.00010212668712483719],[0.38434484601020813, 0.6011176109313965],[0.1227547824382782, 0.21505290269851685, 0.18034367263317108, 0.21505290269851685, 0.144041046500206, 0.1227547824382782],[0.9571394920349121],[0.008980188518762589, 0.9604202508926392],[0.7764821648597717, 0.031931109726428986],[0.03456258028745651, 0.8961324691772461, 0.031237207353115082],[0.7462195754051208],[0.011514166370034218, 0.011514166370034218, 0.011514166370034218, 0.011514166370034218, 0.2235485166311264, 0.07920719683170319, 0.07150280475616455, 0.011514166370034218, 0.011514166370034218, 0.2235485166311264, 0.07920719683170319, 0.24238654971122742],[0.0004913644515909255, 0.7927004098892212],[0.6480297446250916]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>