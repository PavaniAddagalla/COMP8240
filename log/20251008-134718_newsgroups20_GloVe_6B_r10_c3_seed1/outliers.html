
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists <unk> <unk> ists","polysyllabic polysyllabic","autodesk bbs","bullshit","unsubscribe","unsubscribe","dir","yep","isbn","commodore cdtv","<unk>","<unk> <unk>","mhz iisi","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","lou gehrig <unk>","abolish cults","deleted","compuserve com","liar cheat <unk>","pierre turgeon islanders","ken","secrecy lds ceremonies clh","<unk> fantasy <unk> dear elf","dino ciccarelli ray sheppard","okay okay forgot <unk>","dancing <unk>","xli xloadimage goto flag","comp graphics faq","<unk> jeremy scott noonan","mjones donald aix kingston ibm com","greetings sorry typos clipper hooks","exit","brandon wise <unk> nyx edu","dreams","gee forgotten nut","subscribe <unk> <unk> eve <unk>","insult gregg resorts lies","alt religion spam","joke","article apr nmt edu erickson <unk> nmt edu alan erickson","remind bosnia ethnic cleansing <unk>","posted","virtualgrabkeys resource belongs olvwm","article apr csi jpl nasa gov <unk> <unk> jpl nasa gov dan <unk>","article <unk> sys bison baden sys bison baden bari","objects <unk>","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","consistently","fox <unk> dave feustel nmyi feustel netcom com"];
var att_heads = [9,9,9,6,9,9,9,6,9,9,0,0,9,0,6,9,1,9,6,2,6,5,6,6,6,6,5,2,6,9,6,8,6,6,6,2,6,6,6,5,6,9,2,2,0,2,6,6,6,6];
var trigram_weights = [[0.1855924427509308, 0.14782235026359558, 0.18547022342681885, 0.14782235026359558, 0.14782235026359558, 0.18547022342681885],[0.007566037122160196, 0.007566037122160196],[0.13215595483779907, 0.35171812772750854],[0.0268117543309927],[0.07084153592586517],[0.07084153592586517],[0.13056574761867523],[0.02495689131319523],[0.7371459007263184],[0.8812240362167358, 0.0027459075208753347],[0.3333333432674408],[0.125, 0.125],[0.6851457357406616, 0.00365238543599844],[0.0881224200129509, 0.08529631793498993, 0.08529631793498993, 0.16591987013816833, 0.23444685339927673, 0.0044056992046535015, 0.08529631793498993, 0.16591987013816833, 0.08529631793498993],[0.9027402400970459, 0.008171770721673965, 0.04454396665096283],[0.9762937426567078, 0.008616184815764427],[0.7278271317481995],[0.6831501126289368, 0.30033645033836365],[0.10552962124347687, 0.6184089779853821, 0.13803072273731232],[0.3488363027572632, 0.0023609381169080734, 0.531461238861084],[0.948587954044342],[0.5929798483848572, 0.07282987982034683, 0.23176422715187073, 0.05121305584907532],[0.007878351956605911, 0.13021336495876312, 0.007878351956605911, 0.8493298888206482, 0.004700017627328634],[0.0077339052222669125, 0.00022015388822183013, 0.8530407547950745, 0.012782656587660313],[0.1818162202835083, 0.1818162202835083, 0.5560433864593506, 0.016064835712313652],[0.9537557363510132, 0.023122167214751244],[4.5016102376393974e-05, 0.0051827747374773026, 0.0005255999276414514, 0.9890637993812561],[0.00025804125471040606, 0.9697871208190918, 0.0018302227836102247],[0.011185352690517902, 0.10087580978870392, 0.8403573036193848, 0.002840101718902588],[0.004781837575137615, 0.007768246345221996, 0.0015190019039437175, 0.005282754078507423, 0.8888973593711853, 0.08696885406970978],[0.10467071831226349, 0.8105504512786865, 0.00011637023999355733, 0.0018954203696921468, 0.07137569040060043],[0.9785881042480469],[0.12219751626253128, 0.8644818067550659, 0.012487017549574375, 0.0001179060127469711, 0.0007157872896641493],[0.9751158952713013],[0.0796654149889946, 0.8466249704360962, 0.02827649563550949],[0.2750803828239441, 0.020177265629172325, 0.020177265629172325, 0.6442105174064636, 0.020177265629172325],[0.2770501971244812, 0.030535005033016205, 0.023059101775288582, 0.6529338955879211],[0.0012350424658507109, 0.9209503531455994, 0.06584753841161728],[0.9791466593742371],[0.31343430280685425, 1.2004596101178322e-05, 2.3509734091931023e-05, 0.00011744983930839226, 0.003261473961174488, 0.0021977482829242945, 2.3509734091931023e-05, 0.00011744983930839226, 0.6775510907173157, 0.003261473961174488],[0.2331608682870865, 0.5704507827758789, 0.19137798249721527, 0.0015944833867251873, 0.003415910294279456],[0.9940317273139954],[0.013031255453824997, 0.3242539167404175, 0.6366522908210754, 0.013031255453824997],[0.14754067361354828, 8.516434718330856e-06, 0.00037589570274576545, 1.5744664779049344e-05, 0.31907305121421814, 0.0009183690999634564, 0.0014516995288431644, 0.0014516995288431644, 1.5744664779049344e-05, 0.31907305121421814, 0.0009183690999634564, 0.20770548284053802, 0.0014516995288431644],[0.9794471263885498, 0.007466625887900591, 1.9679508113767952e-05, 0.001320969662629068, 0.0012887755874544382, 1.9679508113767952e-05, 0.001320969662629068, 0.0012887755874544382, 0.00036083918530493975],[0.9715468883514404, 0.014226588420569897],[0.0076016150414943695, 0.0076016150414943695, 0.0076016150414943695, 0.0076016150414943695, 0.0076016150414943695, 0.0004357439174782485, 0.0012235294561833143, 0.0076016150414943695, 0.0076016150414943695, 0.0076016150414943695, 0.0004357439174782485, 0.9370920062065125],[0.9840351343154907],[0.9896939396858215],[0.5840563178062439, 0.0025563130620867014, 0.3957666754722595, 8.09075718279928e-05, 0.0025563130620867014, 8.09075718279928e-05, 0.00027747603598982096, 0.012068801559507847]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>