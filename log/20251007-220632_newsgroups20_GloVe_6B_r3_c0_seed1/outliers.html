
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["polysyllabic polysyllabic","dir","apr <unk> ists <unk> <unk> ists","bullshit","unsubscribe","unsubscribe","yep","autodesk bbs","isbn","<unk>","<unk> <unk>","commodore cdtv","pierre turgeon islanders","dino ciccarelli ray sheppard","lou gehrig <unk>","jsn jeremy scott noonan","ernest <unk> jcs sage purdue edu <unk> sage jcs","abolish cults","mhz iisi","ken","xli xloadimage goto flag","compuserve com","religious fanaticism","liar cheat <unk>","deleted","secrecy lds ceremonies clh","career mattingly","dancing <unk>","brandon wise <unk> nyx edu","david","fuhr rings <unk> errey bob rings","exit","dreams","article <unk> sys bison baden sys bison baden bari","<unk> fantasy <unk> dear elf","posted","insult gregg <unk> lies","okay okay forgot <unk>","kent wife","article apr nmt edu erickson <unk> nmt edu alan erickson","jesus peace","consistently","boston seattle boston seattle riles <unk> <unk> <unk> greenwell <unk> dawson griffey vaughn <unk> <unk> boone cooper martinez john <unk> <unk> pena valle vizquel totals totals","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","blessed hunger thirst righteousness filled","bill mcd","ultimate <unk>","xli xloadimage imagemagick export lcs mit edu contrib","joke","overall career mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly"];
var att_heads = [2,2,2,0,2,2,0,2,2,0,0,2,1,1,0,1,1,1,2,0,1,2,1,0,2,1,1,0,0,1,1,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,0,1,0,1];
var trigram_weights = [[0.48673516511917114, 0.48673516511917114],[0.858069896697998],[0.24382904171943665, 0.0007718612323515117, 0.3769277036190033, 0.0007718612323515117, 0.0007718612323515117, 0.3769277036190033],[0.9983602166175842],[0.9772525429725647],[0.9942143559455872],[0.999432384967804],[0.48779264092445374, 0.5118823647499084],[0.996236264705658],[0.3333333432674408],[0.3333333432674408, 0.3333333432674408],[0.3265470564365387, 0.6725345849990845],[0.3802344501018524, 5.482627602759749e-05, 0.6190282702445984],[0.0014130257768556476, 5.3961989578965586e-06, 0.9479468464851379, 0.006749116815626621],[0.7895714044570923, 0.20934759080410004, 0.000540505163371563],[0.0019286174792796373, 0.13488300144672394, 0.8611278533935547, 0.0001319554285146296],[0.9446473121643066, 0.01329103298485279, 0.00025464032660238445, 0.0039036902599036694, 0.02034580707550049, 0.0001081595110008493, 0.01329103298485279, 0.0039036902599036694, 0.00025464032660238445],[0.9701889753341675, 0.0005596436094492674],[0.6963984370231628, 0.30206677317619324],[0.9986742734909058],[2.521141868783161e-05, 0.003250323934480548, 2.9549886676250026e-05, 0.993444561958313],[0.2533567547798157, 0.7406214475631714],[0.995528519153595, 1.924628122651484e-05],[0.27838414907455444, 0.7215160131454468, 4.9915255658561364e-05],[0.9985104203224182],[0.0013860120670869946, 0.05257820710539818, 0.9419302940368652, 0.0020527541637420654],[0.998532772064209, 6.583725280506769e-06],[0.996904194355011, 0.001547858933918178],[0.017066245898604393, 0.9826915860176086, 9.529131784802303e-05, 5.022016921429895e-05, 1.4311907534647617e-06],[0.9924180507659912],[3.4780365240294486e-05, 0.01554146222770214, 0.0059360298328101635, 1.0242321877740324e-05, 0.9569999575614929, 0.01554146222770214],[0.9940930008888245],[0.9994840621948242],[0.7475365996360779, 0.004056613892316818, 1.4029507156010368e-06, 0.0011661709286272526, 0.08429790288209915, 1.4029507156010368e-06, 0.0011661709286272526, 0.08429790288209915, 0.07341930270195007],[0.00016443674394395202, 0.006203269120305777, 0.00016443674394395202, 0.9934654831886292, 2.3819334273866843e-06],[0.9980359673500061],[0.9358468055725098, 0.014403929002583027, 7.371727406280115e-05, 0.04967550188302994],[0.20129477977752686, 0.20129477977752686, 0.5973958969116211, 1.4581820323655847e-05],[0.3221832811832428, 0.6768810749053955],[0.48470816016197205, 2.799811954901088e-05, 2.711599790927721e-06, 2.1405125153250992e-05, 0.0005792604642920196, 0.0026303380727767944, 2.711599790927721e-06, 2.1405125153250992e-05, 0.5114268064498901, 0.0005792604642920196],[0.0666452944278717, 0.932761013507843],[0.8518457412719727],[0.17923401296138763, 0.019033880904316902, 0.17923401296138763, 0.019033880904316902, 2.0350567808691267e-07, 0.00038595215301029384, 0.00038595215301029384, 0.00038595215301029384, 8.131017921186867e-07, 0.00038595215301029384, 0.05274712294340134, 3.7969448385410942e-06, 5.901512486161664e-05, 0.00038595215301029384, 0.00038595215301029384, 0.0016424545319750905, 0.06489884853363037, 0.0026531214825809, 0.2589041292667389, 0.00038595215301029384, 0.00038595215301029384, 0.004594244994223118, 0.003351506544277072, 1.1062771818615147e-06, 0.1057601273059845, 0.1057601273059845],[0.0037062042392790318, 0.0037062042392790318, 0.0037062042392790318, 0.0037062042392790318, 0.0037062042392790318, 3.016029040736612e-05, 6.092581315897405e-05, 0.0037062042392790318, 0.0037062042392790318, 0.0037062042392790318, 3.016029040736612e-05, 0.9702291488647461],[0.0008962691063061357, 0.580595850944519, 4.970244117430411e-05, 3.6316591831564438e-06, 0.4184545874595642],[0.9987592697143555, 7.26804955775151e-06],[0.9800106287002563, 0.0024986560456454754],[1.6863616110640578e-05, 0.0021741045638918877, 0.0021741045638918877, 0.9932940006256104, 7.667761565244291e-06, 0.0001415402948623523, 1.769237860571593e-05, 0.0021741045638918877],[0.9999303817749023],[0.6364713907241821, 0.36349982023239136, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06, 2.3966972548805643e-06]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>