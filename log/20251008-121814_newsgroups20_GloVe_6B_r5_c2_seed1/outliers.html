
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["polysyllabic polysyllabic","autodesk bbs","apr <unk> ists <unk> <unk> ists","dir","unsubscribe","unsubscribe","bullshit","yep","isbn","commodore cdtv","mhz iisi","<unk>","<unk> <unk>","lou gehrig <unk>","dino ciccarelli ray sheppard","<unk> jeremy scott noonan","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","xli xloadimage goto flag","pierre turgeon islanders","compuserve com","deleted","abolish cults","ken","comp graphics faq","liar cheat <unk>","shut andi","article <unk> sys bison baden sys bison baden bari","quoting dougb ecs comm mot com article apr <unk> comm mot com","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","dancing <unk>","<unk> file dis <unk> file tga","posted","secrecy lds ceremonies clh","exit","okay okay forgot <unk>","mjones donald aix kingston ibm com","brandon wise <unk> nyx edu","caching drive","david","article apr nmt edu erickson <unk> nmt edu alan erickson","career mattingly","bill mcd","dreams","fox <unk> dave feustel nmyi feustel netcom com","grease <unk> cool rider","kent wife","<unk> fantasy <unk> dear elf","religious fanaticism","boston seattle boston seattle riles <unk> <unk> <unk> greenwell <unk> dawson griffey vaughn <unk> <unk> boone cooper martinez john <unk> <unk> pena valle vizquel totals totals","fuhr rings <unk> errey bob rings"];
var att_heads = [3,1,1,1,0,0,0,0,1,1,1,0,0,0,4,4,4,4,4,1,1,2,0,1,0,2,3,3,4,0,1,4,3,2,0,1,0,4,4,4,4,2,0,0,3,4,0,3,4,4];
var trigram_weights = [[0.5, 0.5],[0.2855512797832489, 0.7144486904144287],[0.9290289282798767, 0.0035038499627262354, 0.03022977150976658, 0.0035038499627262354, 0.0035038499627262354, 0.03022977150976658],[0.7983514666557312],[0.9981525540351868],[0.9981525540351868],[0.9983980059623718],[0.9999130964279175],[0.9957323670387268],[0.9846904873847961, 0.015309537760913372],[0.9993797540664673, 0.0006201597861945629],[0.5],[0.25, 0.25],[0.8058012127876282, 0.19247128069400787, 0.0008637252612970769],[0.024656148627400398, 0.00017974658112507313, 0.8761028051376343, 0.09906131774187088],[0.0003697292413562536, 0.4245750308036804, 0.5749240517616272, 0.0001311268424615264],[0.8160712122917175, 0.004602017812430859, 0.004602017812430859, 0.040993042290210724, 0.08281321078538895, 0.0007214174838736653, 0.004602017812430859, 0.040993042290210724, 0.004602017812430859],[8.082002750597894e-05, 0.0024420320987701416, 4.414092836668715e-05, 0.9974330067634583],[0.9424335956573486, 0.0006308821612037718, 0.05219578370451927],[0.6741147041320801, 0.3064005374908447],[0.968853771686554],[0.9999793767929077, 2.0631132429116406e-05],[0.9995207786560059],[0.022079244256019592, 0.9554189443588257, 0.02142113447189331],[0.5651358962059021, 0.43472275137901306, 7.067163096508011e-05],[0.9988582134246826, 0.00021993274276610464],[0.9909318685531616, 0.001400004024617374, 2.1721666598750744e-06, 0.00029474939219653606, 3.477933569229208e-05, 2.1721666598750744e-06, 0.00029474939219653606, 3.477933569229208e-05, 4.673182047554292e-06],[0.011688017286360264, 0.0013900382909923792, 3.4070391848217696e-05, 3.9743954971527273e-07, 7.554999319836497e-05, 9.32698640099261e-06, 0.9838780164718628, 5.915859583183192e-05, 0.0013900382909923792, 3.9743954971527273e-07, 7.554999319836497e-05, 9.32698640099261e-06],[0.0019412818364799023, 0.0019412818364799023, 0.0019412818364799023, 0.0019412818364799023, 0.0019412818364799023, 0.00030431736377067864, 6.708340515615419e-05, 0.0019412818364799023, 0.0019412818364799023, 0.0019412818364799023, 0.00030431736377067864, 0.9837939143180847],[0.9993264675140381, 0.0006735514616593719],[0.0008877890068106353, 0.4900362491607666, 0.0026512437034398317, 0.0008877890068106353, 0.4900362491607666, 0.015500723384320736],[0.9991899132728577],[0.9935213923454285, 0.005426589399576187, 0.0003077246656175703, 0.0001488428097218275],[0.9992291927337646],[0.3647972345352173, 0.3647972345352173, 0.27036410570144653, 2.0720064640045166e-05],[0.0007967755664139986, 1.864063847278885e-06, 0.30323734879493713, 0.0008452437468804419, 0.6191457509994507, 0.07517628371715546],[0.10274215787649155, 0.8966262936592102, 0.00020174338715150952, 0.00012889454956166446, 0.00030084108584560454],[1.7631521131988848e-06, 0.9999982118606567],[0.9980306029319763],[0.1975538730621338, 0.0009102405747398734, 2.733206883931416e-06, 0.00017110352928284556, 0.08842173963785172, 0.0010914915474131703, 2.733206883931416e-06, 0.00017110352928284556, 0.6232532858848572, 0.08842173963785172],[0.9999953508377075, 4.6573659346904606e-06],[0.9975513815879822, 0.0024486128240823746],[0.9996861219406128],[0.007046365644782782, 0.0002563558518886566, 0.9827374815940857, 0.002415907569229603, 0.0002563558518886566, 0.002415907569229603, 7.406194345094264e-05, 0.004797504749149084],[1.2938218105773558e-06, 0.0013688973849639297, 0.9986009001731873, 2.891480653488543e-05],[0.4433399438858032, 0.5566600561141968],[8.275542495539412e-05, 0.009891110472381115, 8.275542495539412e-05, 0.9884939789772034, 0.0013666319428011775],[0.5511888861656189, 0.44865089654922485],[0.1274181604385376, 0.18637888133525848, 0.1274181604385376, 0.18637888133525848, 4.029648792425178e-08, 0.00010298560664523393, 0.00010298560664523393, 0.00010298560664523393, 8.436862799499067e-07, 0.00010298560664523393, 0.01742185279726982, 4.861586421611719e-05, 0.0004041071224492043, 0.00010298560664523393, 0.00010298560664523393, 0.0736815556883812, 0.04249326139688492, 0.016250470653176308, 0.16240711510181427, 0.00010298560664523393, 0.00010298560664523393, 0.0018545332131907344, 0.0394168421626091, 0.0020050068851560354, 0.007747389376163483, 0.007747389376163483],[0.0008465956198051572, 0.25727906823158264, 0.008060507476329803, 1.950893783941865e-05, 0.4765152037143707, 0.25727906823158264]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>