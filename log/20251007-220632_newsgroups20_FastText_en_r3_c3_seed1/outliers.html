
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk>","<unk> <unk>","dir","isbn","polysyllabic polysyllabic","commodore cdtv","unsubscribe","unsubscribe","mhz iisi","deleted","autodesk bbs","ken","lou gehrig <unk>","posted","exit","dreams","apr <unk> ists <unk> <unk> ists","consistently","please subscrive","please subscrive","david","ignore","test","test","dancing <unk>","unfortunately","mistake","<unk> jeremy scott noonan","objects <unk>","career mattingly","italy sweden canada sweden russia italy","alt law enforcement","<unk> phones","joke","ultimate <unk>","simple","religious fanaticism","tell","<unk> order","bullshit","good","yes","alt religion spam","got <unk>","<unk> weasel <unk> later","bill mcd","wanted sips","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","urban areas","liar cheat <unk>"];
var att_heads = [0,0,0,0,0,0,0,0,0,2,0,0,0,2,2,1,0,2,2,2,0,2,2,2,1,2,2,0,1,1,0,1,1,2,2,2,1,2,1,0,2,2,0,2,2,0,2,0,1,0];
var trigram_weights = [[0.5],[0.25, 0.25],[0.8411402702331543],[0.6539433002471924],[0.5, 0.5],[0.2175857573747635, 0.2608047425746918],[0.3195926547050476],[0.3195926547050476],[0.8390092253684998, 0.16099075973033905],[0.5631857514381409],[0.15578150749206543, 0.8442184925079346],[0.671134352684021],[0.5543277263641357, 0.14855742454528809, 0.14855742454528809],[0.9349686503410339],[0.27337437868118286],[0.6741173267364502],[0.2154332995414734, 0.0908319354057312, 0.2560354471206665, 0.0908319354057312, 0.0908319354057312, 0.2560354471206665],[0.9594227075576782],[0.8800808191299438, 0.11991921812295914],[0.8800808191299438, 0.11991921812295914],[0.8698276877403259],[0.9589347839355469],[0.1692085564136505],[0.1692085564136505],[0.9270702600479126, 0.07292971014976501],[0.9224175214767456],[0.10434582084417343],[0.07842838019132614, 0.37318170070648193, 0.3915331959724426, 0.07842838019132614],[0.9890690445899963, 0.010930937714874744],[0.9889017343521118, 0.011098295450210571],[0.07275369763374329, 0.2706763446331024, 0.13102778792381287, 0.2706763446331024, 0.14023588597774506, 0.07275369763374329],[0.010941581800580025, 0.24506965279579163, 0.7417368292808533],[0.008622351102530956, 0.991377592086792],[0.10124117881059647],[0.462413489818573, 0.5375865697860718],[0.873538076877594],[0.23004668951034546, 0.7699533104896545],[0.9587650299072266],[0.01635965146124363, 0.9836403727531433],[0.6433988213539124],[0.911216676235199],[0.442290335893631],[0.11644413322210312, 0.04982314258813858, 0.2282404750585556],[0.9421697854995728, 0.05783017724752426],[0.10301027446985245, 0.002672027563676238, 0.10301027446985245, 0.6882971525192261],[0.022853905335068703, 0.8052616119384766],[0.9719924926757812, 0.02800755761563778],[0.01828351616859436, 0.01828351616859436, 0.01828351616859436, 0.01828351616859436, 0.215255469083786, 0.11151207238435745, 0.11459103971719742, 0.01828351616859436, 0.01828351616859436, 0.215255469083786, 0.11151207238435745, 0.12217272073030472],[0.5526064038276672, 0.38022011518478394],[0.13791924715042114, 0.05504689738154411, 0.4035169184207916]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>