
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["polysyllabic polysyllabic","autodesk bbs","unsubscribe","unsubscribe","apr <unk> ists <unk> <unk> ists","bullshit","dir","yep","isbn","commodore cdtv","<unk>","<unk> <unk>","mhz iisi","compuserve com","pierre turgeon islanders","xli xloadimage goto flag","lou gehrig <unk>","dino ciccarelli ray sheppard","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","abolish cults","deleted","<unk> jeremy scott noonan","ken","liar cheat <unk>","comp graphics faq","quoting dougb ecs comm mot com article apr <unk> comm mot com","fox <unk> dave feustel nmyi feustel netcom com","brandon wise <unk> nyx edu","shut andi","dancing <unk>","okay okay forgot <unk>","posted","article <unk> sys bison baden sys bison baden bari","bill mcd","exit","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","secrecy lds ceremonies clh","<unk> fantasy <unk> dear elf","david","<unk> file dis <unk> file tga","xli xloadimage imagemagick export lcs mit edu contrib","fuhr rings <unk> errey bob rings","dreams","grease <unk> cool rider","caching drive","article apr nmt edu erickson <unk> nmt edu alan erickson","blessed hunger thirst righteousness filled","insult gregg resorts lies","mjones donald aix kingston ibm com","career mattingly"];
var att_heads = [1,2,1,1,2,1,2,1,2,0,0,0,2,2,0,0,1,0,0,2,2,0,0,1,2,0,0,1,0,1,1,0,2,0,0,0,0,1,0,2,2,0,1,1,0,0,0,1,0,0];
var trigram_weights = [[0.5, 0.5],[0.6704606413841248, 0.32953932881355286],[0.9997761845588684],[0.9984356760978699],[0.3670397996902466, 0.008287078700959682, 0.299905925989151, 0.008287078700959682, 0.008287078700959682, 0.299905925989151],[0.9975199103355408],[0.6673019528388977],[0.999945878982544],[0.5423994064331055],[0.9791152477264404, 1.2844510592913139e-06],[0.5],[0.5, 0.5],[0.9989436268806458, 0.001056369161233306],[0.7755661010742188, 0.22443394362926483],[0.6724705696105957, 0.004625234752893448, 0.32245030999183655],[6.179276624607155e-06, 0.000715862785000354, 1.4225487348085153e-06, 0.9992765784263611],[0.8743199110031128, 0.12511838972568512, 0.00028085187659598887],[0.03180983290076256, 7.794512384862173e-06, 0.6331008672714233, 0.33316412568092346],[0.9315234422683716, 0.00174831529147923, 0.00174831529147923, 0.00012056518608005717, 0.054194241762161255, 5.473406781675294e-05, 0.00174831529147923, 0.00012056518608005717, 0.00174831529147923],[0.6899538040161133, 0.24586451053619385],[0.9930909872055054],[0.0001931677252287045, 0.41393253207206726, 0.5857753753662109, 9.89785767160356e-05],[0.9993727803230286],[0.7512097954750061, 0.2486647218465805, 6.273778853937984e-05],[0.006256069988012314, 0.9735525846481323, 0.01971915178000927],[0.2998979985713959, 0.0019058049656450748, 1.4036846778253675e-06, 3.580875329589617e-07, 1.4260831449064426e-06, 0.005018346011638641, 0.683984637260437, 0.0003582689387258142, 0.0019058049656450748, 3.580875329589617e-07, 1.4260831449064426e-06, 0.005018346011638641],[0.40866634249687195, 0.00021849761833436787, 0.590300440788269, 4.986090971215162e-07, 0.00021849761833436787, 4.986090971215162e-07, 1.9891473129973747e-05, 0.0005753455916419625],[0.005196452606469393, 0.9947395920753479, 3.8182130083441734e-05, 2.432869041513186e-05, 1.4760662452317774e-06],[0.9988974332809448, 0.001102565904147923],[0.998389482498169, 0.0016105949180200696],[0.3774363100528717, 0.3774363100528717, 0.24510875344276428, 9.324008715339005e-06],[0.9996808767318726],[0.9214635491371155, 0.002369300462305546, 0.008539712987840176, 0.029493188485503197, 5.03710652992595e-05, 0.008539712987840176, 0.029493188485503197, 5.03710652992595e-05, 5.668709945894079e-07],[0.9999969005584717, 3.0982041607785504e-06],[0.997593343257904],[0.0010125183034688234, 0.0010125183034688234, 0.0010125183034688234, 0.0010125183034688234, 0.0010125183034688234, 3.169864066876471e-05, 5.275222974887583e-06, 0.0010125183034688234, 0.0010125183034688234, 0.0010125183034688234, 3.169864066876471e-05, 0.9918311238288879],[5.4363921663025394e-05, 0.0003044967306777835, 0.9981156587600708, 0.0007627420127391815],[3.749108509509824e-05, 0.005117615684866905, 3.749108509509824e-05, 0.9947237968444824, 8.372099546249956e-05],[0.9989801049232483],[0.0009031239314936101, 0.4955219626426697, 0.000546559109352529, 0.0009031239314936101, 0.4955219626426697, 0.0066032796166837215],[0.005981875583529472, 0.0011117903050035238, 0.0011117903050035238, 0.8289914727210999, 0.05014888569712639, 0.11035565286874771, 7.492727308999747e-05, 0.0011117903050035238],[0.00011851683666463941, 0.02529928833246231, 0.003714790800586343, 3.1451802442461485e-06, 0.9455649852752686, 0.02529928833246231],[0.99992835521698],[0.5325485467910767, 0.0019090990535914898, 0.45127609372138977, 0.006629787385463715],[2.529414757646009e-07, 0.9999997615814209],[0.1398562788963318, 7.325631304411218e-05, 3.782368480642617e-07, 1.2199770935694687e-05, 0.12844891846179962, 0.00038968535955064, 3.782368480642617e-07, 1.2199770935694687e-05, 0.6015887260437012, 0.12844891846179962],[0.00069078104570508, 0.12618429958820343, 1.5902575114523643e-06, 2.3604496163898148e-05, 0.8730997443199158],[0.9645833373069763, 0.03382329270243645, 6.260395366552984e-07, 0.0015136857982724905],[0.0008525307639501989, 0.3733658194541931, 8.0809795690584e-06, 0.6224809288978577, 0.00019529936253093183, 0.002244875067844987],[0.999964714050293, 3.534232746460475e-05]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>