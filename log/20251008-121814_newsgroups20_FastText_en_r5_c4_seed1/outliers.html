
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["dir","isbn","commodore cdtv","unsubscribe","unsubscribe","mhz iisi","autodesk bbs","polysyllabic polysyllabic","urn <unk>","deleted","ken","lou gehrig <unk>","exit","posted","test","test","apr <unk> ists <unk> <unk> ists","<unk> phones","dancing <unk>","ignore","david","<unk> jeremy scott noonan","dreams","cheek","compuserve com","please subscrive","please subscrive","career mattingly","bill mcd","mistake","<unk> order","consistently","ultimate <unk>","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","mjones donald aix kingston ibm com","wanted sips","unfortunately","italy sweden canada sweden russia italy","tell","joke","simple","caching drive","alt law enforcement","find","got <unk>","bullshit","good","inline inline correct","yes","ego trip"];
var att_heads = [3,3,3,0,0,3,3,4,0,1,3,3,0,1,0,0,3,0,0,1,3,3,0,0,3,2,2,0,0,0,0,4,4,3,3,1,4,3,1,0,4,0,0,1,1,0,4,4,2,0];
var trigram_weights = [[0.9005046486854553],[0.8507665991783142],[0.9078786373138428, 0.046060651540756226],[0.04313777759671211],[0.13628466427326202],[0.9498149752616882, 0.02509249746799469],[0.020206987857818604, 0.9595860242843628],[0.4627307951450348, 0.4627307951450348],[0.9025557637214661, 0.04872208833694458],[0.9844006896018982],[0.9425622820854187],[0.9681877493858337, 0.010604103095829487, 0.010604103095829487],[0.9190249443054199],[0.9964535236358643],[0.9105565547943115],[0.9105565547943115],[0.4429188668727875, 0.006457420531660318, 0.2656256854534149, 0.006457420531660318, 0.006457420531660318, 0.2656256854534149],[0.05382256582379341, 0.8923549056053162],[0.8592823147773743, 0.07035882025957108],[0.9715219140052795],[0.9611212015151978],[0.004086105152964592, 0.5583484172821045, 0.4293932318687439, 0.004086105152964592],[0.8861859440803528],[0.5993794798851013],[0.7063089609146118, 0.28604206442832947],[0.9709925055503845, 0.014503750950098038],[0.9709925055503845, 0.014503750950098038],[0.9886131286621094, 0.005693438462913036],[0.8743941783905029, 8.68557981448248e-05],[0.8083588480949402],[0.020926233381032944, 0.9581475853919983],[0.9100683927536011],[0.8634275794029236, 0.019510352984070778],[0.0012004761956632137, 0.0012004761956632137, 0.0012004761956632137, 0.0012004761956632137, 0.3025527596473694, 0.06449753791093826, 0.050958555191755295, 0.0012004761956632137, 0.0012004761956632137, 0.3025527596473694, 0.06449753791093826, 0.2077379822731018],[0.0012357264058664441, 0.2273191213607788, 0.10127748548984528, 0.4569939374923706, 0.16696281731128693, 0.04621095582842827],[0.9986188411712646, 0.0003526743676047772],[0.7356257438659668],[0.11936815083026886, 0.2099454402923584, 0.18511097133159637, 0.2099454402923584, 0.15626181662082672, 0.11936815083026886],[0.9942259192466736],[0.89156174659729],[0.9933857321739197],[0.2509889602661133, 0.3254355490207672],[0.0053583006374537945, 0.7056246399879456, 0.2840360105037689],[0.9938876032829285],[0.9906415343284607, 0.0013369170483201742],[0.7077900767326355],[0.9952141046524048],[0.26224285364151, 0.26224285364151, 0.4590189456939697],[0.8973024487495422],[0.3709944784641266, 0.618036687374115]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>