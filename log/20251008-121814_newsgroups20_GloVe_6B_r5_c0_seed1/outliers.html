
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["polysyllabic polysyllabic","dir","apr <unk> ists <unk> <unk> ists","bullshit","unsubscribe","unsubscribe","yep","autodesk bbs","isbn","commodore cdtv","<unk> <unk>","<unk>","mhz iisi","lou gehrig <unk>","pierre turgeon islanders","dino ciccarelli ray sheppard","ernest <unk> jcs sage purdue edu <unk> sage jcs","abolish cults","jsn jeremy scott noonan","ken","xli xloadimage goto flag","deleted","compuserve com","dancing <unk>","liar cheat <unk>","secrecy lds ceremonies clh","career mattingly","david","exit","article <unk> sys bison baden sys bison baden bari","religious fanaticism","dreams","okay okay forgot <unk>","posted","shut andi","overall career mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly mattingly","kent wife","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","insult gregg <unk> lies","consistently","gee forgotten nut","brandon wise <unk> nyx edu","dog thrust","joke","article apr nmt edu erickson <unk> nmt edu alan erickson","ultimate <unk>","<unk> fantasy <unk> dear elf","italy sweden canada sweden russia italy","<unk> file dis <unk> file tga","fuhr rings <unk> errey bob rings"];
var att_heads = [0,0,0,2,0,0,2,0,0,0,0,0,0,2,4,4,4,1,4,4,4,0,0,2,2,3,4,4,1,3,3,2,2,4,1,4,4,4,2,3,2,2,2,2,4,2,2,4,0,4];
var trigram_weights = [[0.5, 0.5],[0.9778882265090942],[0.11966337263584137, 0.0003106130752712488, 0.4397023916244507, 0.0003106130752712488, 0.0003106130752712488, 0.4397023916244507],[0.9981722831726074],[0.9982374906539917],[0.9982374906539917],[0.9999382495880127],[0.39560142159461975, 0.6043986082077026],[0.9977350234985352],[0.5139426589012146, 0.486057311296463],[0.5, 0.5],[0.5],[0.6232042908668518, 0.36661800742149353],[0.8237419128417969, 0.1756698340177536, 0.00029409705894067883],[0.44556695222854614, 6.132861744845286e-05, 0.5541372895240784],[0.04703202471137047, 2.974379412989947e-06, 0.9412795305252075, 0.008558178320527077],[0.6442477703094482, 0.0007568211294710636, 4.002630248578498e-06, 0.00012067553325323388, 0.35227787494659424, 0.000954530609305948, 0.0007568211294710636, 0.00012067553325323388, 4.002630248578498e-06],[0.9999986886978149, 1.2628981949092122e-06],[0.0002519765985198319, 0.30155035853385925, 0.6955679655075073, 0.0026296547148376703],[0.9990482926368713],[1.2085846719855908e-05, 0.0010665447916835546, 4.637670826923568e-06, 0.998916745185852],[0.9993020296096802],[0.38261744379997253, 0.6173825860023499],[0.9978041052818298, 0.00031369534553959966],[0.7640608549118042, 0.23369236290454865, 0.00112340715713799],[0.6071221232414246, 0.12004342675209045, 0.2688558101654053, 0.001989348791539669],[0.9999784231185913, 2.1572939658653922e-05],[0.9991148114204407],[0.9990170001983643],[0.8938869833946228, 0.0032500154338777065, 0.00010143603140022606, 0.049494873732328415, 0.00020696046703960747, 0.00010143603140022606, 0.049494873732328415, 0.00020696046703960747, 6.478135219367687e-06],[0.9878805875778198, 0.012119421735405922],[0.999843955039978],[0.2228277027606964, 0.2228277027606964, 0.5543122291564941, 1.618174064788036e-05],[0.9998345375061035],[0.9996614456176758, 0.00033854099456220865],[0.5802437663078308, 0.41945400834083557, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06, 9.049053005583119e-06],[0.4756268262863159, 0.5243731737136841],[0.0008777330513112247, 0.0008777330513112247, 0.0008777330513112247, 0.0008777330513112247, 0.0008777330513112247, 0.0011070292675867677, 9.886185580398887e-06, 0.0008777330513112247, 0.0008777330513112247, 0.0008777330513112247, 0.0011070292675867677, 0.990754246711731],[0.37029144167900085, 0.47878187894821167, 0.0005176618578843772, 0.14989133179187775],[0.9979165196418762],[0.04249115288257599, 0.7886155247688293, 0.16868528723716736],[0.06599095463752747, 0.9312821626663208, 0.00024972311803139746, 0.0017226540949195623, 5.37174537384999e-06],[0.999945878982544, 5.4128489864524454e-05],[0.9999562501907349],[0.233738511800766, 6.2981807786854915e-06, 3.503521668335452e-07, 0.0005966547760181129, 0.0865451768040657, 0.00047307112254202366, 3.503521668335452e-07, 0.0005966547760181129, 0.5896055102348328, 0.0865451768040657],[0.9949507713317871, 0.00504921143874526],[0.0001604752178536728, 0.0963187962770462, 0.0001604752178536728, 0.9031959772109985, 3.751615849978407e-06],[0.16326509416103363, 0.17497414350509644, 0.24803127348423004, 0.17497414350509644, 0.07549028098583221, 0.16326509416103363],[0.00019930963753722608, 0.452723890542984, 0.08371879160404205, 0.00019930963753722608, 0.452723890542984, 0.010434784926474094],[1.1627623280219268e-05, 0.022366924211382866, 0.0006271630409173667, 7.544323352703941e-07, 0.9546266794204712, 0.022366924211382866]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>