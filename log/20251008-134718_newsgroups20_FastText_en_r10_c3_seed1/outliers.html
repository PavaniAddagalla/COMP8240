
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","<unk>","dir","isbn","autodesk bbs","mhz iisi","commodore cdtv","unsubscribe","unsubscribe","deleted","polysyllabic polysyllabic","lou gehrig <unk>","apr <unk> ists <unk> <unk> ists","ken","italy sweden canada sweden russia italy","david","<unk> jeremy scott noonan","pierre turgeon islanders","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","please subscrive","please subscrive","exit","mjones donald aix kingston ibm com","compuserve com","dreams","jesus peace","posted","bill mcd","dancing <unk>","<unk> phones","dino ciccarelli ray sheppard","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","test","test","secrecy lds ceremonies clh","mistake","shut andi","objects <unk>","ignore","unfortunately","bullshit","career mattingly","world championships germany group standings munich group standings dortmund canada czech republic sweden germany russia usa switzerland finland italy norway austria france april italy russia norway germany sweden austria usa czech republic april canada switzerland russia austria finland france april sweden canada czech republic germany switzerland italy finland usa april germany france italy sweden czech republic norway april switzerland russia usa france austria canada norway finland april switzerland austria germany finland april russia sweden czech republic france canada italy usa norway april sweden switzerland finland czech republic russia canada germany usa april austria italy france norway playoffs april quarterfinals sweden usa russia germany april quarterfinals canada finland italy switzerland czech republic april relegation april semifinals may relegation bronze medal game may final","joke","alt religion spam","abolish cults","article apr csi jpl nasa gov <unk> <unk> jpl nasa gov dan <unk>","world championships germany group standings munich group standings dortmund canada czech republic russia finland sweden usa italy germany switzerland france austria norway april italy russia norway germany sweden austria usa czech republic april canada switzerland russia austria finland france april sweden canada czech republic germany switzerland italy finland usa april germany france italy sweden czech republic norway april switzerland russia usa france austria canada norway finland april switzerland austria germany finland april russia sweden czech republic france canada italy usa norway april sweden switzerland finland czech republic russia canada germany usa april austria italy france norway playoffs april quarterfinals april quarterfinals april relegation april semifinals may relegation bronze medal game may final","religious fanaticism","consistently"];
var att_heads = [0,0,9,9,9,9,9,9,9,4,9,9,9,9,3,9,9,9,0,5,5,8,6,9,9,9,4,9,9,9,9,9,9,9,1,1,9,9,0,3,9,9,2,9,9,9,4,2,9,0];
var trigram_weights = [[0.125, 0.125],[0.3333333432674408],[0.01920054852962494],[0.034693554043769836],[0.4873160719871521, 0.02536783739924431],[0.014637588523328304, 0.49268120527267456],[0.058594826608896255, 0.4707026183605194],[0.0739232525229454],[0.0739232525229454],[0.04946066066622734],[0.011857076548039913, 0.011857076548039913],[0.03965025022625923, 0.3201166093349457, 0.3201166093349457],[0.01537177711725235, 0.3096880316734314, 0.02778209000825882, 0.3096880316734314, 0.3096880316734314, 0.02778209000825882],[0.16610951721668243],[0.16686280071735382, 0.18665970861911774, 0.21727128326892853, 0.18665970861911774, 0.07568366825580597, 0.16686280071735382],[0.11213630437850952],[0.15949177742004395, 0.021069662645459175, 0.021979646757245064, 0.15949177742004395],[0.025820987299084663, 0.39557433128356934, 0.18303035199642181],[0.13857336342334747, 0.13857336342334747, 0.13857336342334747, 0.13857336342334747, 0.03405556455254555, 0.017504049465060234, 0.010150527581572533, 0.13857336342334747, 0.13857336342334747, 0.03405556455254555, 0.017504049465060234, 0.05529008433222771],[0.24618342518806458, 0.3769082725048065],[0.24618342518806458, 0.3769082725048065],[0.20485049486160278],[0.33217763900756836, 0.03912582993507385, 0.039035700261592865, 0.04336966946721077, 0.08175990730524063, 0.13235372304916382],[0.1638738363981247, 0.17833751440048218],[0.11251797527074814],[0.007396567612886429, 0.053333405405282974],[0.25998109579086304],[0.045377541333436966, 0.009589055553078651],[0.10450264066457748, 0.44774872064590454],[0.44097763299942017, 0.11804469674825668],[0.017332743853330612, 0.18814656138420105, 0.027148472145199776, 0.014785988256335258],[0.028661083430051804, 0.20818409323692322, 0.20818409323692322, 0.04305553063750267, 0.03367890045046806, 0.018812527880072594, 0.20818409323692322, 0.04305553063750267, 0.20818409323692322],[0.18678951263427734],[0.18678951263427734],[0.17225277423858643, 0.05013737827539444, 0.05681202933192253, 0.36039891839027405],[0.09172669053077698],[0.2879716157913208, 0.12338335067033768],[0.17062367498874664, 0.41468819975852966],[0.312068909406662],[0.49349960684776306],[0.14307129383087158],[0.21231980621814728, 0.39384007453918457],[0.016645221039652824, 0.002341186860576272, 0.012760852463543415, 0.038000911474227905, 0.0030043362639844418, 0.0018899732967838645, 0.038000911474227905, 0.0030043362639844418, 0.0032828280236572027, 0.007183805573731661, 0.003664308460429311, 0.004626022186130285, 0.006289495620876551, 0.012760852463543415, 0.002540708053857088, 0.011789759621024132, 0.011158832348883152, 0.0060329376719892025, 0.005614854861050844, 0.009481809101998806, 0.004342732485383749, 0.007523444015532732, 0.0025575633626431227, 0.005614854861050844, 0.002540708053857088, 0.009481809101998806, 0.012760852463543415, 0.006289495620876551, 0.004342732485383749, 0.011789759621024132, 0.003664308460429311, 0.004626022186130285, 0.0025575633626431227, 0.007183805573731661, 0.011158832348883152, 0.002540708053857088, 0.004342732485383749, 0.0060329376719892025, 0.007523444015532732, 0.0025575633626431227, 0.006289495620876551, 0.007183805573731661, 0.003664308460429311, 0.004626022186130285, 0.012760852463543415, 0.011158832348883152, 0.005614854861050844, 0.0060329376719892025, 0.011789759621024132, 0.0025575633626431227, 0.012760852463543415, 0.007523444015532732, 0.005614854861050844, 0.006289495620876551, 0.003664308460429311, 0.004626022186130285, 0.009481809101998806, 0.0025575633626431227, 0.011158832348883152, 0.002540708053857088, 0.011789759621024132, 0.007523444015532732, 0.004342732485383749, 0.007183805573731661, 0.009481809101998806, 0.0060329376719892025, 0.0025575633626431227, 0.011158832348883152, 0.004342732485383749, 0.012760852463543415, 0.0060329376719892025, 0.0025575633626431227, 0.002540708053857088, 0.006289495620876551, 0.003664308460429311, 0.004626022186130285, 0.007523444015532732, 0.007183805573731661, 0.005614854861050844, 0.011789759621024132, 0.009481809101998806, 0.0025575633626431227, 0.006289495620876551, 0.011158832348883152, 0.0060329376719892025, 0.003664308460429311, 0.004626022186130285, 0.002540708053857088, 0.007183805573731661, 0.012760852463543415, 0.011789759621024132, 0.0025575633626431227, 0.004342732485383749, 0.005614854861050844, 0.007523444015532732, 0.009481809101998806, 0.002883658278733492, 0.0025575633626431227, 0.001038649003021419, 0.006289495620876551, 0.011789759621024132, 0.002540708053857088, 0.012760852463543415, 0.0025575633626431227, 0.001038649003021419, 0.007183805573731661, 0.0060329376719892025, 0.005614854861050844, 0.011158832348883152, 0.003664308460429311, 0.004626022186130285, 0.0025575633626431227, 0.002358760917559266, 0.0025575633626431227, 0.0011895569041371346, 0.01004476472735405, 0.002358760917559266, 0.007875865325331688, 0.009520363993942738, 0.018562261015176773, 0.01004476472735405, 0.028998803347349167],[0.15697680413722992],[0.08646821230649948, 0.12937031686306, 0.16565071046352386],[0.26481911540031433, 0.06826817244291306],[0.11817450821399689, 0.010455734096467495, 0.01396872941404581, 0.027950052171945572, 0.05154496431350708, 0.04205455631017685, 0.18293704092502594, 0.18293704092502594, 0.027950052171945572, 0.05154496431350708, 0.04205455631017685, 0.06549080461263657, 0.18293704092502594],[0.018414873629808426, 0.0025900923646986485, 0.014117534272372723, 0.04204101115465164, 0.003323744982481003, 0.002090907422825694, 0.04204101115465164, 0.003323744982481003, 0.0036318448837846518, 0.007947558537125587, 0.004053882788866758, 0.005117841996252537, 0.0028108255937695503, 0.006674335338175297, 0.0069581689313054085, 0.013043198734521866, 0.0062118032947182655, 0.014117534272372723, 0.01234519388526678, 0.00832330621778965, 0.0048044342547655106, 0.010489877313375473, 0.0028294732328504324, 0.0062118032947182655, 0.0028108255937695503, 0.010489877313375473, 0.014117534272372723, 0.0069581689313054085, 0.0048044342547655106, 0.013043198734521866, 0.004053882788866758, 0.005117841996252537, 0.0028294732328504324, 0.007947558537125587, 0.01234519388526678, 0.0028108255937695503, 0.0048044342547655106, 0.006674335338175297, 0.00832330621778965, 0.0028294732328504324, 0.0069581689313054085, 0.007947558537125587, 0.004053882788866758, 0.005117841996252537, 0.014117534272372723, 0.01234519388526678, 0.0062118032947182655, 0.006674335338175297, 0.013043198734521866, 0.0028294732328504324, 0.014117534272372723, 0.00832330621778965, 0.0062118032947182655, 0.0069581689313054085, 0.004053882788866758, 0.005117841996252537, 0.010489877313375473, 0.0028294732328504324, 0.01234519388526678, 0.0028108255937695503, 0.013043198734521866, 0.00832330621778965, 0.0048044342547655106, 0.007947558537125587, 0.010489877313375473, 0.006674335338175297, 0.0028294732328504324, 0.01234519388526678, 0.0048044342547655106, 0.014117534272372723, 0.006674335338175297, 0.0028294732328504324, 0.0028108255937695503, 0.0069581689313054085, 0.004053882788866758, 0.005117841996252537, 0.00832330621778965, 0.007947558537125587, 0.0062118032947182655, 0.013043198734521866, 0.010489877313375473, 0.0028294732328504324, 0.0069581689313054085, 0.01234519388526678, 0.006674335338175297, 0.004053882788866758, 0.005117841996252537, 0.0028108255937695503, 0.007947558537125587, 0.014117534272372723, 0.013043198734521866, 0.0028294732328504324, 0.0048044342547655106, 0.0062118032947182655, 0.00832330621778965, 0.010489877313375473, 0.00319023709744215, 0.0028294732328504324, 0.0011490739416331053, 0.0028294732328504324, 0.0011490739416331053, 0.0028294732328504324, 0.002609534887596965, 0.0028294732328504324, 0.0013160257367417216, 0.011112683452665806, 0.002609534887596965, 0.008713195100426674, 0.010532530024647713, 0.020535724237561226, 0.011112683452665806, 0.03208183869719505],[0.1522170454263687, 0.08808868378400803],[0.4348973035812378]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>