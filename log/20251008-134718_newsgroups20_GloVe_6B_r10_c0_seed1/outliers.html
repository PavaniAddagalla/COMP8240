
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists <unk> <unk> ists","polysyllabic polysyllabic","dir","autodesk bbs","bullshit","unsubscribe","unsubscribe","isbn","yep","commodore cdtv","mhz iisi","<unk>","<unk> <unk>","ernest <unk> jcs sage purdue edu <unk> sage jcs","compuserve com","lou gehrig <unk>","deleted","abolish cults","pierre turgeon islanders","ken","secrecy lds ceremonies clh","liar cheat <unk>","comp graphics faq","dino ciccarelli ray sheppard","xli xloadimage goto flag","jsn jeremy scott noonan","posted","dancing <unk>","subscribe xpert <unk> eve <unk>","mjones donald aix kingston ibm com","insult gregg <unk> lies","virtualgrabkeys resource belongs olvwm","exit","<unk> fantasy <unk> dear elf","article <unk> sys bison baden sys bison baden bari","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","quoting dougb ecs comm mot com article apr <unk> comm mot com","xli xloadimage imagemagick export lcs mit edu contrib","article apr csi jpl nasa gov <unk> <unk> jpl nasa gov dan <unk>","fox <unk> dave feustel nmyi feustel netcom com","dreams","objects <unk>","okay okay forgot <unk>","article apr nmt edu erickson <unk> nmt edu alan erickson","flat engine","alt religion spam","brandon wise <unk> nyx edu","<unk> file dis <unk> file tga","gee forgotten nut"];
var att_heads = [5,0,5,3,9,6,6,5,9,5,5,0,0,3,5,3,5,3,3,5,8,1,5,5,3,3,5,3,5,7,5,5,5,5,5,8,8,4,5,5,5,7,5,4,5,5,5,5,5,9];
var trigram_weights = [[0.017033791169524193, 0.32686784863471985, 0.0011813802411779761, 0.32686784863471985, 0.32686784863471985, 0.0011813802411779761],[0.0033089336939156055, 0.0033089336939156055],[0.06638343632221222],[0.045787569135427475, 0.9542123675346375],[0.07646758109331131],[0.33258190751075745],[0.33258190751075745],[0.36130204796791077],[0.2941717505455017],[0.9987634420394897, 0.0012365804286673665],[0.5185186862945557, 0.0005647645448334515],[0.5],[0.5, 0.5],[0.25368404388427734, 0.04168844223022461, 0.0010640994878485799, 0.30848556756973267, 0.0423005148768425, 0.001539174234494567, 0.04168844223022461, 0.30848556756973267, 0.0010640994878485799],[0.08112119138240814, 0.9188787937164307],[0.8690499663352966, 0.015230982564389706, 0.05785952880978584],[0.9772951602935791],[0.8234142065048218, 0.0027628145180642605],[0.38809680938720703, 0.0007325903279706836, 0.5969918370246887],[0.9719459414482117],[0.884425699710846, 0.003508265595883131, 0.08138494193553925, 0.03068104013800621],[0.02687440998852253, 0.9598217606544495, 0.006651956122368574],[0.0021854268852621317, 0.963679313659668, 0.006647731643170118],[0.012284982018172741, 0.00011595607065828517, 0.9858923554420471, 0.0017066649161279202],[7.47267113183625e-05, 0.017389938235282898, 0.00021353924239519984, 0.9127620458602905],[0.004211840685456991, 0.026395650580525398, 0.9510939717292786, 0.0014511642511934042],[0.9556117057800293],[0.9883636236190796, 0.011636292561888695],[0.3936162292957306, 0.018950065597891808, 0.018950065597891808, 0.5305835008621216, 0.018950065597891808],[0.004976761527359486, 0.3987833559513092, 0.00015953026013448834, 0.0023528081364929676, 0.5279659032821655, 0.06078492850065231],[0.5488932132720947, 0.00338076357729733, 0.005213714204728603, 0.43729856610298157],[0.004029726143926382, 0.15677374601364136, 0.8190479278564453, 0.004029726143926382],[0.9943199157714844],[0.004994548391550779, 0.44468194246292114, 0.004994548391550779, 0.5163138508796692, 0.02402057684957981],[0.9749933481216431, 0.007875708863139153, 5.4519419791176915e-05, 0.004013517405837774, 0.0003224126121494919, 5.4519419791176915e-05, 0.004013517405837774, 0.0003224126121494919, 0.00047434086445719004],[0.010759474709630013, 0.010759474709630013, 0.010759474709630013, 0.010759474709630013, 0.010759474709630013, 0.00040025930502451956, 0.0020342087373137474, 0.010759474709630013, 0.010759474709630013, 0.010759474709630013, 0.00040025930502451956, 0.9110895395278931],[0.9883283972740173],[0.04563682898879051, 0.0066205961629748344, 5.339756535249762e-05, 0.0003439586143940687, 0.00011516155063873157, 0.08083177357912064, 0.7783606648445129, 0.0001260135613847524, 0.0066205961629748344, 0.0003439586143940687, 0.00011516155063873157, 0.08083177357912064],[1.6218646123888902e-05, 0.0043137166649103165, 0.0043137166649103165, 0.8278451561927795, 3.083266710746102e-05, 0.15470147132873535, 0.0001514434552518651, 0.0043137166649103165],[0.20301100611686707, 8.545687887817621e-05, 0.00019899207109119743, 0.0001334477128693834, 0.07503346353769302, 0.001642872579395771, 0.0016398633597418666, 0.0016398633597418666, 0.0001334477128693834, 0.07503346353769302, 0.001642872579395771, 0.6365254521369934, 0.0016398633597418666],[0.4877063035964966, 0.002235911786556244, 0.4523302912712097, 4.1034334572032094e-05, 0.002235911786556244, 4.1034334572032094e-05, 0.016705485060811043, 0.03646817058324814],[0.9946581721305847],[0.9890385866165161, 0.010961368680000305],[0.324919193983078, 0.324919193983078, 0.3467434346675873, 0.0017090908950194716],[0.5858178734779358, 0.0002465981524437666, 0.0012406582245603204, 0.0001661304704612121, 0.0272540096193552, 0.004732063971459866, 0.0012406582245603204, 0.0001661304704612121, 0.3471497893333435, 0.0272540096193552],[0.4056834876537323, 0.5943165421485901],[0.0022574185859411955, 0.8257377743721008, 0.16827012598514557],[0.022525081411004066, 0.968479573726654, 0.004395443946123123, 5.016337308916263e-05, 0.0001543126127216965],[0.0037500711623579264, 0.496141642332077, 0.0002058089739875868, 0.0037500711623579264, 0.496141642332077, 1.0848685633391142e-05],[0.0717925876379013, 0.80054771900177, 0.12585411965847015]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>