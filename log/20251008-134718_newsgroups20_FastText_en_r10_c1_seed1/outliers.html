
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","dir","isbn","autodesk bbs","mhz iisi","commodore cdtv","unsubscribe","unsubscribe","deleted","polysyllabic polysyllabic","lou gehrig <unk>","ken","apr <unk> ists dchhabra stpl ists","david","<unk> jeremy scott noonan","italy sweden canada sweden russia italy","pierre turgeon islanders","compuserve com","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","mjones donald aix kingston ibm com","exit","bill mcd","<unk> phones","dino ciccarelli ray sheppard","posted","test","test","please subscrive","please subscrive","dreams","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","dancing <unk>","jesus peace","objects <unk>","cheek","career mattingly","secrecy lds ceremonies clh","<unk> <unk> project arizona","<unk> order","ignore","religious fanaticism","fuhr rings <unk> errey bob rings","mistake","abolish cults","ultimate <unk>","comp graphics faq","bullshit","shut andi","alt law enforcement","liar cheat <unk>"];
var att_heads = [0,4,4,4,8,4,4,4,8,8,4,8,4,4,4,4,1,9,4,4,8,4,4,6,6,8,8,2,2,4,9,4,4,5,4,7,4,4,7,8,8,4,5,4,7,4,4,8,4,7];
var trigram_weights = [[0.3333333432674408, 0.3333333432674408],[0.09634780883789062],[0.04787399247288704],[0.13610506057739258, 0.047264523804187775],[0.07027748972177505, 0.4648612439632416],[0.1602652668952942, 0.4198673963546753],[0.0801909938454628],[0.0801909938454628],[0.2789171040058136],[0.2996613085269928, 0.2996613085269928],[0.17054305970668793, 0.2764856517314911, 0.2764856517314911],[0.20015642046928406],[0.07612046599388123, 0.14904378354549408, 0.08933030813932419, 0.14904378354549408, 0.14904378354549408, 0.08933030813932419],[0.0780622661113739],[0.25397536158561707, 0.12198659032583237, 0.11608735471963882, 0.25397536158561707],[0.21806947886943817, 0.047135770320892334, 0.258902370929718, 0.047135770320892334, 0.21068711578845978, 0.21806947886943817],[0.11383689939975739, 0.5251566171646118, 0.3610064387321472],[0.2400030940771103, 0.31638994812965393],[0.13258807361125946, 0.13258807361125946, 0.13258807361125946, 0.13258807361125946, 0.040455397218465805, 0.014865821227431297, 0.015243624337017536, 0.13258807361125946, 0.13258807361125946, 0.040455397218465805, 0.014865821227431297, 0.0785854384303093],[0.4056120812892914, 0.14748361706733704, 0.04411892965435982, 0.03555324301123619, 0.09782624989748001, 0.26940587162971497],[0.17428286373615265],[0.4699691832065582, 0.04586196690797806],[0.369183748960495, 0.2616324722766876],[0.29580605030059814, 0.21081997454166412, 0.21958932280540466, 0.06296461075544357],[0.3829604983329773],[0.42479684948921204],[0.42479684948921204],[0.33919423818588257, 0.3304028809070587],[0.33919423818588257, 0.3304028809070587],[0.36454153060913086],[0.11695598810911179, 0.11614996194839478, 0.11614996194839478, 0.1280083805322647, 0.032089754939079285, 0.014187714084982872, 0.11614996194839478, 0.1280083805322647, 0.11614996194839478],[0.3865933120250702, 0.3067033588886261],[0.12875139713287354, 0.10552120208740234],[0.439491331577301, 0.2802543640136719],[0.46348175406455994],[0.3942258358001709, 0.30288708209991455],[0.09604645520448685, 0.0907922238111496, 0.19884151220321655, 0.3071599006652832],[0.23731236159801483, 0.23731236159801483, 0.5126933455467224, 0.01268193032592535],[0.22364577651023865, 0.5527084469795227],[0.4730077087879181],[0.43940243124961853, 0.2140139937400818],[0.016327381134033203, 0.16517765820026398, 0.1414652168750763, 0.1414652168750763, 0.08745639771223068, 0.16517765820026398],[0.4750429093837738],[0.46853116154670715, 0.1495833694934845],[0.21943551301956177, 0.11150921136140823],[0.09616412222385406, 0.11099430173635483, 0.06793146580457687],[0.354538232088089],[0.32077354192733765, 0.3101697564125061],[0.049615196883678436, 0.33952778577804565, 0.3233467638492584],[0.20435667037963867, 0.3796962797641754, 0.20797352492809296]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>