
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","<unk>","dir","isbn","commodore cdtv","autodesk bbs","mhz iisi","unsubscribe","unsubscribe","lou gehrig <unk>","deleted","polysyllabic polysyllabic","<unk> jeremy scott noonan","ken","mjones donald aix kingston ibm com","david","italy sweden canada sweden russia italy","apr <unk> ists <unk> <unk> ists","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","pierre turgeon islanders","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","compuserve com","bill mcd","dino ciccarelli ray sheppard","exit","<unk> phones","dancing <unk>","posted","dreams","please subscrive","please subscrive","jesus peace","test","test","fox <unk> dave feustel nmyi feustel netcom com","secrecy lds ceremonies clh","career mattingly","shut andi","comp graphics faq","objects <unk>","bullshit","alt religion spam","mistake","xli xloadimage imagemagick export lcs mit edu contrib","ignore","liar cheat <unk>","religious fanaticism","joke","alt law enforcement","ultimate <unk>"];
var att_heads = [0,0,8,8,1,1,1,7,7,1,9,7,7,1,6,9,1,3,8,3,8,5,3,7,1,1,1,6,9,9,9,8,3,3,1,6,1,8,5,8,9,8,6,1,6,0,5,9,1,3];
var trigram_weights = [[0.3333333432674408, 0.3333333432674408],[0.3333333432674408],[0.026049800217151642],[0.026108717545866966],[0.1266593039035797, 0.43667036294937134],[0.40882518887519836, 0.18234965205192566],[0.05753177031874657, 0.47123411297798157],[0.029100924730300903],[0.007437561172991991],[0.31826725602149963, 0.2272442728281021, 0.2272442728281021],[0.4633522927761078],[0.09143457561731339, 0.09143457561731339],[0.2207706868648529, 0.0767826959490776, 0.2609052062034607, 0.2207706868648529],[0.5310155749320984],[0.3480941355228424, 0.2612665593624115, 0.042857199907302856, 0.0785098448395729, 0.17224036157131195, 0.09703190624713898],[0.1899542510509491],[0.14603106677532196, 0.1848326325416565, 0.21029898524284363, 0.1848326325416565, 0.12797358632087708, 0.14603106677532196],[0.06841570883989334, 0.12713158130645752, 0.0843973457813263, 0.12713158130645752, 0.12713158130645752, 0.0843973457813263],[0.10612700879573822, 0.10612700879573822, 0.10612700879573822, 0.10612700879573822, 0.010697520337998867, 0.004807918798178434, 0.028055161237716675, 0.10612700879573822, 0.10612700879573822, 0.010697520337998867, 0.004807918798178434, 0.19804492592811584],[0.10657662898302078, 0.2295779585838318, 0.43426749110221863],[0.02917495183646679, 0.05866305157542229, 0.05866305157542229, 0.21237188577651978, 0.01545619498938322, 0.002657638629898429, 0.05866305157542229, 0.21237188577651978, 0.05866305157542229],[0.3368953466415405, 0.14359940588474274],[0.6643016338348389, 0.010859183967113495],[0.10188522189855576, 0.39420393109321594, 0.41922664642333984, 0.08468414843082428],[0.46958234906196594],[0.31327584385871887, 0.3734482526779175],[0.5922764539718628, 0.2038617730140686],[0.6038638949394226],[0.5640493631362915],[0.591251015663147, 0.2043745070695877],[0.591251015663147, 0.2043745070695877],[0.2978353798389435, 0.47345033288002014],[0.2599183917045593],[0.5841665863990784],[0.2592636048793793, 0.08821079134941101, 0.1876961886882782, 0.08821079134941101, 0.08821079134941101, 0.08821079134941101, 0.08821079134941101, 0.02377541922032833],[0.2155393809080124, 0.030825210735201836, 0.3124869167804718, 0.2205742448568344],[0.5923338532447815, 0.20383311808109283],[0.4524361491203308, 0.24996250867843628],[0.35401877760887146, 0.2792350947856903, 0.17721343040466309],[0.5268393754959106, 0.23658031225204468],[0.5866029262542725],[0.02011551894247532, 0.8244374394416809, 0.1554470956325531],[0.643509566783905],[0.002944700885564089, 0.1404094249010086, 0.015364306047558784, 0.3953245282173157, 0.1404094249010086, 0.13905318081378937, 0.006411397363990545, 0.019673630595207214],[0.32659652829170227],[0.26100707054138184, 0.4733206629753113, 0.13283613324165344],[0.479326993227005, 0.33745986223220825],[0.5715893507003784],[0.021987756714224815, 0.5333501100540161, 0.1781906932592392],[0.6815959215164185, 0.15920205414295197]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>