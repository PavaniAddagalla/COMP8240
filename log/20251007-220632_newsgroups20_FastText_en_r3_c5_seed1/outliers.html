
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","dir","isbn","commodore cdtv","mhz iisi","autodesk bbs","unsubscribe","unsubscribe","polysyllabic polysyllabic","deleted","lou gehrig <unk>","ken","exit","<unk> jeremy scott noonan","apr <unk> ists <unk> <unk> ists","test","test","<unk> phones","david","bill mcd","italy sweden canada sweden russia italy","posted","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","compuserve com","mjones donald aix kingston ibm com","dancing <unk>","career mattingly","cheek","ignore","dreams","comp graphics faq","pierre turgeon islanders","dino ciccarelli ray sheppard","mistake","please subscrive","please subscrive","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","joke","objects ufos","<unk> order","ultimate <unk>","caching drive","xli xloadimage imagemagick export lcs mit edu contrib","subscribe <unk> <unk> eve <unk>","unfortunately","bullshit","<unk> subscrive please subscribe","please subscribe","please subscribe","please subscribe"];
var att_heads = [0,1,1,1,1,1,1,1,2,0,1,1,2,1,1,2,2,1,1,1,1,0,1,1,1,1,1,1,2,1,1,1,1,2,0,0,1,1,1,1,2,2,1,2,2,1,0,0,0,0];
var trigram_weights = [[0.5, 0.5],[0.87256920337677],[0.984632134437561],[0.9459078907966614, 0.054092079401016235],[0.9661325216293335, 0.03386743739247322],[0.02859831228852272, 0.9714016318321228],[0.6694507598876953],[0.6694507598876953],[0.330798864364624, 0.330798864364624],[0.8518416881561279],[0.8475978970527649, 0.05080069229006767, 0.05080069229006767],[0.9683471322059631],[0.29764431715011597],[0.007603545673191547, 0.38597342371940613, 0.591215968132019, 0.007603545673191547],[0.3274509310722351, 0.007406632415950298, 0.31035131216049194, 0.007406632415950298, 0.007406632415950298, 0.31035131216049194],[0.665327250957489],[0.665327250957489],[0.11786165088415146, 0.6464150547981262],[0.9826362133026123],[0.20194406807422638, 0.7980559468269348],[0.08369854092597961, 0.27808472514152527, 0.1489858627319336, 0.27808472514152527, 0.12744762003421783, 0.08369854092597961],[0.9733052253723145],[0.0069445231929421425, 0.0069445231929421425, 0.0069445231929421425, 0.0069445231929421425, 0.13301514089107513, 0.06350917369127274, 0.1722850799560547, 0.0069445231929421425, 0.0069445231929421425, 0.13301514089107513, 0.06350917369127274, 0.3929990828037262],[0.6977949142456055, 0.30220505595207214],[0.0048248982056975365, 0.1430473029613495, 0.1885536015033722, 0.38675907254219055, 0.20165248215198517, 0.07033771276473999],[0.9293853640556335, 0.07061461359262466],[0.8923288583755493, 0.1076711043715477],[0.7315807938575745],[0.9057101011276245],[0.8803048729896545],[0.5618386268615723, 0.12890292704105377, 0.289379745721817],[0.5603786706924438, 0.009239640086889267, 0.3657042384147644],[0.31793534755706787, 0.00642875861376524, 0.24009349942207336, 0.42911359667778015],[0.6800887584686279],[0.9761018753051758, 0.023898055776953697],[0.9761018753051758, 0.023898055776953697],[0.2792854905128479, 0.007986778393387794, 0.007986778393387794, 0.17680318653583527, 0.2621201276779175, 0.07304082810878754, 0.007986778393387794, 0.17680318653583527, 0.007986778393387794],[0.5802004337310791],[0.15306833386421204, 0.8469316959381104],[0.3216061294078827, 0.6783938407897949],[0.8705719113349915, 0.12942807376384735],[0.03294768184423447, 0.9670522809028625],[0.20603325963020325, 0.018694700673222542, 0.013573253527283669, 0.003102722577750683, 0.018694700673222542, 0.16803960502147675, 0.17096710205078125, 0.4008946716785431],[0.0679202526807785, 0.11316206306219101, 0.11316206306219101, 0.026783186942338943, 0.11316206306219101],[0.8666059970855713],[0.9722133874893188],[0.01954941637814045, 0.01954941637814045, 0.7984843254089355, 0.045120298862457275],[0.9465148448944092, 0.053485121577978134],[0.9465148448944092, 0.053485121577978134],[0.7984843254089355, 0.045120298862457275]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>