
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","isbn","dir","commodore cdtv","unsubscribe","unsubscribe","mhz iisi","autodesk bbs","polysyllabic polysyllabic","deleted","ken","lou gehrig <unk>","exit","<unk> phones","apr <unk> ists dchhabra stpl ists","david","test","test","posted","dreams","objects <unk>","dancing <unk>","<unk> jeremy scott noonan","italy sweden canada sweden russia italy","career mattingly","cheek","alt law enforcement","please subscrive","please subscrive","<unk> order","ignore","compuserve com","mistake","ultimate <unk>","bill mcd","alt religion spam","consistently","pierre turgeon islanders","simple","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","unfortunately","religious fanaticism","bullshit","joke","urban areas","mjones donald aix kingston ibm com","good","dino ciccarelli ray sheppard","caching drive","yes"];
var att_heads = [0,3,3,3,2,2,3,3,4,3,3,3,2,0,3,3,0,0,1,0,0,0,3,3,0,0,0,3,3,0,2,3,4,4,3,0,1,3,4,3,4,0,0,0,0,3,4,3,2,3];
var trigram_weights = [[0.5, 0.5],[0.8543811440467834],[0.8710291385650635],[0.8158169388771057, 0.18418309092521667],[0.5165560841560364],[0.8952654004096985],[0.9110870361328125, 0.08891290426254272],[0.06817178428173065, 0.9318282008171082],[0.5, 0.5],[0.7675443887710571],[0.8811522126197815],[0.8373316526412964, 0.054222773760557175, 0.054222773760557175],[0.9970629811286926],[0.010812335647642612, 0.9891876578330994],[0.41792261600494385, 0.031438782811164856, 0.2438805103302002, 0.031438782811164856, 0.031438782811164856, 0.2438805103302002],[0.9628148078918457],[0.9613338708877563],[0.9613338708877563],[0.9835950136184692],[0.8951828479766846],[0.9952182173728943, 0.004781787283718586],[0.972074568271637, 0.027925433591008186],[0.0152537627145648, 0.5408260822296143, 0.3523975908756256, 0.0152537627145648],[0.1637277752161026, 0.18255630135536194, 0.16342094540596008, 0.18255630135536194, 0.1315208077430725, 0.1637277752161026],[0.9958702921867371, 0.004129696171730757],[0.9208135008811951],[0.0008099342230707407, 0.5115582346916199, 0.48326271772384644],[0.7745093107223511, 0.22549065947532654],[0.7745093107223511, 0.22549065947532654],[0.012182764708995819, 0.9878172278404236],[0.9993212223052979],[0.6491167545318604, 0.2735143005847931],[0.9259862899780273],[0.9895106554031372, 0.010489397682249546],[0.019946256652474403, 0.980053722858429],[0.0020770004484802485, 0.9371266961097717, 0.04959224537014961],[0.9817835688591003],[0.8902892470359802, 0.0478825569152832, 0.013945674523711205],[0.995993971824646],[0.007966735400259495, 0.007966735400259495, 0.007966735400259495, 0.007966735400259495, 0.2320181280374527, 0.07272505760192871, 0.13643483817577362, 0.007966735400259495, 0.007966735400259495, 0.2320181280374527, 0.07272505760192871, 0.20627844333648682],[0.939003050327301],[0.1855202615261078, 0.8144797682762146],[0.8875935673713684],[0.9695455431938171],[0.13983970880508423, 0.860160231590271],[0.008037407882511616, 0.3386234641075134, 0.14603358507156372, 0.27377578616142273, 0.15258987247943878, 0.05682763084769249],[0.9982486963272095],[0.14175423979759216, 0.014174573123455048, 0.07516718655824661, 0.7547294497489929],[0.0002694047871045768, 0.9838321208953857],[0.7473938465118408]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>