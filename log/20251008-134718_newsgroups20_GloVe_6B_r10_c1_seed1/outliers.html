
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists dchhabra stpl ists","autodesk bbs","polysyllabic polysyllabic","unsubscribe","unsubscribe","dir","bullshit","isbn","yep","commodore cdtv","mhz iisi","<unk> <unk>","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","compuserve com","deleted","abolish cults","cheek","lou gehrig <unk>","quoting dougb ecs comm mot com article apr <unk> comm mot com","pierre turgeon islanders","liar cheat <unk>","comp graphics faq","secrecy lds ceremonies clh","ken","dino ciccarelli ray sheppard","mjones donald aix kingston ibm com","posted","xli xloadimage goto flag","xli xloadimage imagemagick export lcs mit edu contrib","subscribe <unk> <unk> eve <unk>","article apr csi jpl nasa gov eldred <unk> jpl nasa gov dan eldred","exit","article apr nmt edu erickson <unk> nmt edu alan erickson","<unk> jeremy scott noonan","article <unk> sys bison baden sys bison baden bari","<unk> file dis <unk> file tga","objects <unk>","dancing <unk>","virtualgrabkeys resource belongs olvwm","newsgroup discusses graphic design pcs macs","okay okay forgot <unk>","<unk> phones","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","insult gregg <unk> lies","<unk> fantasy <unk> dear elf","fuhr rings <unk> errey bob rings","alt religion spam","dreams","flat engine"];
var att_heads = [4,4,4,4,4,9,8,8,3,9,7,0,8,4,9,9,8,8,0,4,9,9,8,8,8,4,5,2,4,8,5,8,4,8,9,9,9,8,8,8,4,9,8,8,8,7,4,9,8,8];
var trigram_weights = [[0.0007762828608974814, 0.19970373809337616, 0.0003525068750604987, 0.19970373809337616, 0.19970373809337616, 0.0003525068750604987],[0.0015009114285930991, 0.0025466911029070616],[0.0043609850108623505, 0.0043609850108623505],[0.017615409567952156],[0.017615409567952156],[0.010180137120187283],[0.021293116733431816],[0.019640188664197922],[0.005940176080912352],[0.42762354016304016, 0.001223846571519971],[0.219081848859787, 0.001005325117148459],[0.3333333432674408, 0.3333333432674408],[0.5966498255729675, 0.011030121706426144, 0.011030121706426144, 0.17356561124324799, 0.0008863536641001701, 0.0001820325560402125, 0.011030121706426144, 0.17356561124324799, 0.011030121706426144],[0.0012794072972610593, 0.9900099635124207],[0.9830060601234436],[0.6864451169967651, 0.021682990714907646],[0.9703673124313354],[0.9192265868186951, 0.008661044761538506, 0.036056168377399445],[0.08099260181188583, 0.003205472370609641, 3.270535216870485e-06, 2.3262618924491107e-05, 3.0702765798196197e-05, 0.35722410678863525, 0.19802486896514893, 1.2212901310704183e-05, 0.003205472370609641, 2.3262618924491107e-05, 3.0702765798196197e-05, 0.35722410678863525],[0.41421857476234436, 0.0034800968132913113, 0.5823013186454773],[0.03997410833835602, 0.9433855414390564, 0.00832013227045536],[0.0011971635976806283, 0.8980048298835754, 0.0002411758032394573],[0.03323372080922127, 0.00015676541079301387, 0.9599032402038574, 0.0033530823420733213],[0.9694468379020691],[0.0016000202158465981, 8.946153684519231e-06, 0.9949430823326111, 0.00023169854830484837],[0.0020179199054837227, 0.5323924422264099, 2.273065911140293e-05, 0.0024546270724385977, 0.2337651401758194, 0.22934715449810028],[0.9775640368461609],[1.2234106179676019e-05, 0.004552244208753109, 0.00014960159023758024, 0.9907337427139282],[2.7843118004966527e-05, 0.010259698145091534, 0.010259698145091534, 0.6628984808921814, 3.259434015490115e-05, 0.2958354949951172, 0.00016669459000695497, 0.010259698145091534],[0.034319642931222916, 0.01549087930470705, 0.01549087930470705, 0.9037168622016907, 0.01549087930470705],[0.04986252263188362, 3.118305357929785e-06, 8.205183985410258e-05, 5.352676907932619e-06, 0.3833806812763214, 0.00589476665481925, 1.6148424037965015e-06, 0.000804484763648361, 5.352676907932619e-06, 0.3833806812763214, 0.00589476665481925, 0.17068299651145935, 1.6148424037965015e-06],[0.9908260703086853],[0.2242758721113205, 1.3926129213359673e-05, 6.199433300935198e-06, 5.820810838486068e-05, 0.0008193544344976544, 0.00358258537016809, 6.199433300935198e-06, 5.820810838486068e-05, 0.7560297846794128, 0.0008193544344976544],[0.0038407319225370884, 0.2115071713924408, 0.780608057975769, 0.00020328554091975093],[0.9644231796264648, 0.015392063185572624, 1.3364191545406356e-05, 0.0019630398601293564, 0.00036668471875600517, 1.3364191545406356e-05, 0.0019630398601293564, 0.00036668471875600517, 0.00010655467485776171],[0.0013111879816278815, 0.4978840947151184, 0.0002966473111882806, 0.0013111879816278815, 0.4978840947151184, 1.6148786698977347e-06],[0.9899469017982483, 0.005026599392294884],[0.990638256072998, 0.00468080909922719],[0.0014730767579749227, 0.21074266731739044, 0.786311149597168, 0.0014730767579749227],[0.00025831107632257044, 0.0058236620388925076, 0.1683768630027771, 0.25665202736854553, 0.5656399726867676, 0.0032491148449480534],[0.02015461027622223, 0.02015461027622223, 0.9589982628822327, 0.0006924641202203929],[0.0019977379124611616, 0.9960045218467712],[0.001645428012125194, 0.001645428012125194, 0.001645428012125194, 0.001645428012125194, 0.001645428012125194, 2.715485607041046e-05, 1.6159268852788955e-05, 0.001645428012125194, 0.001645428012125194, 0.001645428012125194, 2.715485607041046e-05, 0.9867660999298096],[0.9884621500968933],[0.4554421603679657, 0.0398373007774353, 0.0016980255022644997, 0.5030225515365601],[0.0010874344734475017, 0.4818902015686035, 0.0010874344734475017, 0.5133857131004333, 0.002549270400777459],[1.665188278821006e-06, 0.36541444063186646, 0.0006983173079788685, 4.934243520438031e-07, 0.2670740783214569, 0.36541444063186646],[0.0011438406072556973, 0.7203035354614258, 0.2618653476238251],[0.9970279335975647],[0.8904146552085876, 0.10768962651491165]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>