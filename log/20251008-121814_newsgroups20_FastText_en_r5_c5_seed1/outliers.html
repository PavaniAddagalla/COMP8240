
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["<unk> <unk>","dir","isbn","commodore cdtv","mhz iisi","autodesk bbs","unsubscribe","unsubscribe","polysyllabic polysyllabic","deleted","lou gehrig <unk>","ken","exit","<unk> phones","<unk> jeremy scott noonan","david","test","test","apr <unk> ists <unk> <unk> ists","posted","italy sweden canada sweden russia italy","dancing <unk>","compuserve com","career mattingly","bill mcd","dreams","cheek","mjones donald aix kingston ibm com","pierre turgeon islanders","mistake","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","please subscrive","please subscrive","ignore","ultimate <unk>","<unk> order","joke","unfortunately","consistently","simple","bullshit","dino ciccarelli ray sheppard","alt law enforcement","caching drive","ego trip","wanted sips","yes","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","religious fanaticism","good"];
var att_heads = [0,4,4,4,4,4,2,2,0,2,4,4,2,1,4,4,1,1,4,2,4,1,4,1,1,1,1,4,4,1,4,3,3,2,0,1,1,0,0,0,1,4,1,2,1,3,2,4,1,0];
var trigram_weights = [[0.3333333432674408, 0.3333333432674408],[0.9786022901535034],[0.98387211561203],[0.8394694328308105, 0.08026532083749771],[0.9200729727745056, 0.011418148875236511],[0.007879851385951042, 0.9842402935028076],[0.7233291864395142],[0.7233291864395142],[0.23966805636882782, 0.23966805636882782],[0.9391887187957764],[0.965230405330658, 0.004967075306922197, 0.004967075306922197],[0.976804792881012],[0.800352156162262],[0.023653974756598473, 0.9526920914649963],[0.0009409523336216807, 0.49319028854370117, 0.5039868950843811, 0.0009409523336216807],[0.9961470365524292],[0.6747873425483704],[0.6747873425483704],[0.44967055320739746, 0.003301356453448534, 0.27021265029907227, 0.003301356453448534, 0.003301356453448534, 0.27021265029907227],[0.9854002594947815],[0.1267167031764984, 0.2467639446258545, 0.1544824242591858, 0.2467639446258545, 0.09855633229017258, 0.1267167031764984],[0.7247974276542664, 0.13760127127170563],[0.7218398451805115, 0.2709182798862457],[0.9939765930175781, 0.0030117123387753963],[0.9856719970703125, 0.0006048968061804771],[0.9687439799308777],[0.277365118265152],[0.0006605186499655247, 0.1903405338525772, 0.17697344720363617, 0.5065773725509644, 0.09941688179969788, 0.024710245430469513],[0.8981761932373047, 0.006179773714393377, 0.08946426212787628],[0.9121607542037964],[0.0011703127529472113, 0.0011703127529472113, 0.0011703127529472113, 0.0011703127529472113, 0.0842791497707367, 0.027852213010191917, 0.1623820960521698, 0.0011703127529472113, 0.0011703127529472113, 0.0842791497707367, 0.027852213010191917, 0.6051629185676575],[0.995216965675354, 0.0023914899211376905],[0.995216965675354, 0.0023914899211376905],[0.997275173664093],[0.7096704840660095, 0.04147564619779587],[0.014163695275783539, 0.9716725945472717],[0.7486653923988342],[0.1583964079618454],[0.5769566297531128],[0.9830650091171265],[0.6424983739852905],[0.11774598807096481, 0.00197801785543561, 0.11106665432453156, 0.761297345161438],[0.001515889074653387, 0.6632071137428284, 0.32992979884147644],[0.001132978475652635, 0.9833739995956421],[0.08716084063053131, 0.9081560969352722],[0.9970818161964417, 0.0010175282368436456],[0.8579131364822388],[0.3328340947628021, 0.00242875749245286, 0.00242875749245286, 0.07475170493125916, 0.4477168917655945, 0.05780188366770744, 0.00242875749245286, 0.07475170493125916, 0.00242875749245286],[0.05031290650367737, 0.9415540099143982],[0.9903283715248108]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>