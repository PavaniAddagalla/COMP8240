
    <html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <style>
    body {
    font-family: Sans-Serif;
    }
    </style>
    </head>
    <body>
    <h3>
    Visualization of Self-Attention Weights
    </h3>
    </body>
    <script>
    var any_text = ["apr <unk> ists <unk> <unk> ists","polysyllabic polysyllabic","autodesk bbs","unsubscribe","unsubscribe","dir","bullshit","isbn","urn <unk>","yep","commodore cdtv","mhz iisi","ernest <unk> <unk> sage purdue edu <unk> sage <unk>","compuserve com","deleted","cheek","lou gehrig <unk>","abolish cults","pierre turgeon islanders","comp graphics faq","liar cheat demagogue","ken","subscribe <unk> <unk> eve <unk>","secrecy lds ceremonies clh","mjones donald aix kingston ibm com","dino ciccarelli ray sheppard","posted","quoting dougb ecs comm mot com article apr <unk> comm mot com","xli xloadimage goto flag","<unk> fantasy <unk> dear elf","<unk> jeremy scott noonan","dancing <unk>","exit","xli xloadimage imagemagick export lcs mit edu contrib","virtualgrabkeys resource belongs olvwm","insult gregg <unk> lies","objects ufos","<unk> file dis <unk> file tga","article <unk> sys bison baden sys bison baden bari","<unk> <unk> umcc umcc umich edu dlc umcc umcc umich edu david","david","alt religion spam","opened distribution","<unk> phones","fuhr rings <unk> errey bob rings","article apr nmt edu erickson <unk> nmt edu alan erickson","fox <unk> dave feustel nmyi feustel netcom com","dreams","flat engine","okay okay forgot <unk>"];
var att_heads = [6,7,9,7,7,3,7,9,5,7,3,3,9,3,7,9,9,5,6,7,8,9,9,9,2,9,2,9,9,8,9,9,4,3,9,9,3,7,9,9,9,9,9,3,9,9,5,9,9,9];
var trigram_weights = [[0.0006237211055122316, 0.24973414838314056, 0.00021989253582432866, 0.24973414838314056, 0.24973414838314056, 0.00021989253582432866],[0.001299314433708787, 0.001299314433708787],[0.1639377474784851, 0.8360622525215149],[0.02511342242360115],[0.02511342242360115],[0.006803511641919613],[0.039094194769859314],[0.00674166064709425],[0.009884081780910492, 0.9901159405708313],[0.19180820882320404],[0.9950124621391296, 0.004987562540918589],[0.9994927644729614, 0.0005072708008810878],[0.4215254783630371, 0.06129458546638489, 0.06129458546638489, 0.14591571688652039, 0.04134530946612358, 0.0001195447111967951, 0.06129458546638489, 0.14591571688652039, 0.06129458546638489],[0.039781030267477036, 0.9104787707328796],[0.9503917694091797],[0.9858497977256775],[0.948985755443573, 0.0024748898576945066, 0.02426964044570923],[0.9057977795600891, 0.09420223534107208],[0.5240840911865234, 0.005728153977543116, 0.45694127678871155],[3.205755319868331e-06, 0.9989205598831177, 1.1187872587470338e-05],[0.1652999073266983, 0.8306562304496765, 0.0002790434518828988],[0.9924889802932739],[0.8126168251037598, 0.0016956620384007692, 0.0016956620384007692, 0.18060053884983063, 0.0016956620384007692],[0.9116837978363037, 0.0005086311139166355, 0.07405699789524078, 0.013750510290265083],[0.0017992268549278378, 0.12302304804325104, 4.504334356170148e-06, 0.0007374215638265014, 0.643750011920929, 0.23068581521511078],[0.001462519052438438, 1.509213416284183e-05, 0.9868640303611755, 0.011658345349133015],[0.9978064894676208],[0.034866295754909515, 0.0017029268201440573, 1.1160581152580562e-06, 1.5921855265332852e-06, 9.966112202164368e-07, 0.20752198994159698, 0.5466738939285278, 3.708001941049588e-06, 0.0017029268201440573, 1.5921855265332852e-06, 9.966112202164368e-07, 0.20752198994159698],[1.0511159416637383e-05, 0.002088559325784445, 5.602373494184576e-05, 0.9957563281059265],[0.000999734620563686, 0.12687577307224274, 0.000999734620563686, 0.8695605397224426, 0.0005644106422550976],[0.0009398132096976042, 0.015397216193377972, 0.9834677577018738, 0.00019526177493389696],[0.9985197186470032, 0.001480304985307157],[0.9990124702453613],[0.00010470461711520329, 0.01902814209461212, 0.01902814209461212, 0.9222280979156494, 2.2571475710719824e-05, 0.02052074670791626, 3.943693081964739e-05, 0.01902814209461212],[0.0003257534699514508, 0.03705889731645584, 0.9622895121574402, 0.0003257534699514508],[0.06932632625102997, 0.0008099598344415426, 0.00042805398697964847, 0.9294357299804688],[0.9997349381446838, 0.0002650179376360029],[0.000714574649464339, 0.4981994032859802, 2.6498482839087956e-05, 0.000714574649464339, 0.4981994032859802, 1.7873456954475841e-06],[0.9913626313209534, 0.0030881627462804317, 4.150597760599339e-06, 0.002571407239884138, 0.00014862595708109438, 4.150597760599339e-06, 0.002571407239884138, 0.00014862595708109438, 0.00010079810454044491],[0.0007988162687979639, 0.0007988162687979639, 0.0007988162687979639, 0.0007988162687979639, 0.0007988162687979639, 1.5579547607558197e-06, 7.325789738388266e-06, 0.0007988162687979639, 0.0007988162687979639, 0.0007988162687979639, 1.5579547607558197e-06, 0.9935990571975708],[0.9991967082023621],[0.000170590661582537, 0.48571211099624634, 0.5105728507041931],[0.3262336850166321, 0.6737663745880127],[0.0009473859681747854, 0.9990525841712952],[5.2788847824558616e-05, 0.3153596520423889, 0.0007240865379571915, 3.634347081060696e-07, 0.36850351095199585, 0.3153596520423889],[0.5374902486801147, 3.6457108762988355e-06, 2.3426237021340057e-06, 3.265473651481443e-06, 0.039945732802152634, 0.00167431915178895, 2.3426237021340057e-06, 3.265473651481443e-06, 0.3725575804710388, 0.039945732802152634],[0.6572989821434021, 0.0004814113781321794, 0.27773600816726685, 1.0199246389674954e-06, 0.0004814113781321794, 1.0199246389674954e-06, 1.7354775991407223e-05, 0.06398283690214157],[0.9984713196754456],[0.7842185497283936, 0.21457022428512573],[0.1417308896780014, 0.1417308896780014, 0.7162445783615112, 0.00029358474421314895]];
var example_range = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50];

    var color = "255,0,0";
    var ngram_length = 3;
    var half_ngram = 1;
    for (var k=0; k < any_text.length; k++) {
    var tokens = any_text[k].split(" ");
    var intensity = new Array(tokens.length);
    var max_intensity = Number.MIN_SAFE_INTEGER;
    var min_intensity = Number.MAX_SAFE_INTEGER;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = 0.0;
    for (var j = -half_ngram; j < ngram_length-half_ngram; j++) {
    if (i+j < intensity.length && i+j > -1) {
    intensity[i] += trigram_weights[k][i + j];
    }
    }
    if (i == 0 || i == intensity.length-1) {
    intensity[i] /= 2.0;
    } else {
    intensity[i] /= 3.0;
    }
    if (intensity[i] > max_intensity) {
    max_intensity = intensity[i];
    }
    if (intensity[i] < min_intensity) {
    min_intensity = intensity[i];
    }
    }
    var denominator = max_intensity - min_intensity;
    for (var i = 0; i < intensity.length; i++) {
    intensity[i] = (intensity[i] - min_intensity) / denominator;
    }
    if (k%2 == 0) {
    var heat_text = "<p><br><b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    } else {
    var heat_text = "<b>" + example_range[k] + ". (h" + att_heads[k] + ")</b><br>";
    }
    var space = "";
    for (var i = 0; i < tokens.length; i++) {
    heat_text += "<span style='background-color:rgba(" + color + "," + intensity[i] + ")'>" + space + tokens[i] + "</span>";
    if (space == "") {
    space = " ";
    }
    }
    //heat_text += "<p>";
    document.body.innerHTML += heat_text;
    }
    </script>
    </html>